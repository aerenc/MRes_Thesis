%% RM THESIS IN EOR - 2021

%% SEVERAL APPROACHES TO UNOBSERVED PRODUCT CHARACTERISTICS WITH SIMULATED DATA UNDER LOGIT & RC-LOGIT SPECIFICATION
% Ali Eren Camur
% Tilburg University - CentER

%%

clc;
clear;

global  beta alpha Total I J M T x m t extra_noise constant share IV price indexxx W Ktheta IDmkt A z tol_inner Kbeta v v_J one Indicator error error_J iterativedelta Kmc zero marginalcost g gg zeta heterogeneity base_heterogeneity

rng('default');                                                            % Setting seed for the whole thesis

%% 1 - SIMULATION:

% In the first part of this code, I will generate the required data:

%% SIMULATION SETTING - LOGIT

% Generating the data for logit case first, we will extend the required data for the RC logit:

alpha         = 2;                    % True alpha
beta          = [3,3,0.5,0.5]';       % True betas (B0 ; B1 ; B2 ; B3)
gamma         = [5,1,0.5,0.5]';       % True gamma
theta_logit   = [beta;-alpha;gamma];  % True theta (but w/o heterogeneity (i.e. sigma) parameters)

I             = 20;                  % Total number of consumers in each market (will be used in estimation part)
J             = 6;                    % Initial total good + outside share in each market
M             = 20;                   % Total markets
T             = 10;                   % Total time period
Total         = J*M*T;                % Total goods present "a priori" i.e. "real" data + first good in first market at first time period,
                                      % INCLUDING outside goods for each M*T market-time combo
one           = 1;
%% CONSTRUCTING INDEXES:

% We construct some indexes for the simulated data: straight out indexes
% correspond to the unmanipulated data and m_ indexes correspond to the
% manipulated data, also constructing the dropping index which is defined
% as in indexes function:

[base_index, base_indexx, base_index2 ,base_index3, index, indexx, index2, index3, indexxx, IDmkt] = indexes(J,M,T,Total); 

%% SIMULATING THE BASE DATA:

% Herein, I simulate the baseline data:

[base_x_jmt, base_w_jmt, base_xi_jmt, base_omega_jmt, base_mc_jmt] = simulateDataUnmanipulated(J,M,T,Total,gamma);
x;
m;
t;
extra_noise;

%% SOLVING FOR SHARES & PRICES FOR UNMANIPULATED DATA BY LOGIT SPECIFICATION:

base_inits                 = zeros(Total-M*T,1);                           % Getting initial values for getting eq. prices

base_solveforprices_logit  = @(ppp) (ppp -(1./(alpha.*(1 - base_shares(ppp,base_x_jmt,base_xi_jmt,base_index,base_index2,base_index3)))) - base_mc_jmt);
opts                 = optimset('Display','iter','TolCon',1E-8,'TolFun',1E-8,'TolX',1E-10,'MaxFunEvals',1000000000);

tic
base_p_jmt_logit     = fsolve(base_solveforprices_logit,base_inits,opts);  % This gives us equilibrium prices for logit-based simulation
toc

base_s_jmt_logit     = base_shares(base_p_jmt_logit,base_x_jmt,base_xi_jmt,base_index,base_index2,base_index3);
                                                                           % This gives us inner market shares                                                                         
cumsum_s_jmt         = cumsum(base_s_jmt_logit);
cumsum_s_jmt_1       = cumsum_s_jmt(J-1,:);
marketwisesum_s_jmt  = diff(cumsum_s_jmt(base_indexx,:)); 
marketwisesum_s_jmt  = [cumsum_s_jmt_1;marketwisesum_s_jmt]; 
base_s0_mt_logit     = 1 - marketwisesum_s_jmt;                            % Getting outside shares for each M*T combo
clear cumsum_s_jmt cumsum_s_jmt_1 marketwisesum_s_jmt marketwisesum_s_jmt

%% SIMULATION SETTING - RC-LOGIT:

% We will introduce heterogeneity on constant term and price:

sigmaa   = [0.2,0.2]';                                                     % Heterogeneity term for RC logit (for constant + price)
theta    = [alpha;beta;sigmaa;gamma];                                      % True theta
base_heterogeneity = randn(2,I);

%% SOLVING FOR SHARES & PRICES FOR UNMANIPULATED DATA BY RC-LOGIT SPECIFICATION:

base_solveforprices = @(pp) (pp -(1./(alpha.*(1 - base_shares_RC(pp,base_x_jmt,base_xi_jmt,sigmaa,base_index,base_index2,base_index3)))) - base_mc_jmt);

tic
base_p_jmt             = fsolve(base_solveforprices,base_inits,opts);      % This gives us equilibrium prices for RC-based simulation
toc

base_s_jmt             = base_shares_RC(base_p_jmt,base_x_jmt,base_xi_jmt,sigmaa,base_index,base_index2,base_index3);     
                                                                           % This gives us inner market shares
cumsum_s_jmt           = cumsum(base_s_jmt);
cumsum_s_jmt_1         = cumsum_s_jmt(J-1,:);
marketwisesum_s_jmt    = diff(cumsum_s_jmt(base_indexx,:)); 
marketwisesum_s_jmt    = [cumsum_s_jmt_1;marketwisesum_s_jmt]; 
base_s0_mt             = 1 - marketwisesum_s_jmt;                          % Getting outside shares for each M*T combo
clear cumsum_s_jmt cumsum_s_jmt_1 marketwisesum_s_jmt 

%% MANIPULATION: GETTING THE "REAL" DATA:

% Now, we will drop the first good from the first market in the first time
% period and resimulate the data for logit and RC-logit cases:

[x_jmt, w_jmt, xi_jmt, omega_jmt, mc_jmt]  = simulateDataManipulated(base_x_jmt,base_w_jmt,base_xi_jmt,base_omega_jmt,base_mc_jmt);

%% SOLVING FOR SHARES & PRICES FOR "REAL" DATA USING LOGIT SPECIFICATION:

inits               = ones(Total-M*T-1,1);                                 % Getting initial values for getting eq. prices

solveforprices_logit= @(pr) (pr -(1./(alpha.*(1 - shares(pr,x_jmt,xi_jmt,index,index2,index3)))) - mc_jmt);

tic
p_jmt_logit         = fsolve(solveforprices_logit,inits,opts);             % This gives us equilibrium prices for logit-based simulation
toc

s_jmt_logit         = shares(p_jmt_logit,x_jmt,xi_jmt,index,index2,index3);% This gives us inner market shares

cumsum_s_jmt         = cumsum(s_jmt_logit);
cumsum_s_jmt_1       = cumsum_s_jmt(J-1,:);
marketwisesum_s_jmt  = diff(cumsum_s_jmt(indexx,:)); 
marketwisesum_s_jmt  = [cumsum_s_jmt_1;marketwisesum_s_jmt]; 
s0_mt_logit          = 1 - marketwisesum_s_jmt;                            % Getting outside shares for each M*T combo
clear cumsum_s_jmt cumsum_s_jmt_1 marketwisesum_s_jmt

%% SOLVING FOR SHARES & PRICES FOR "REAL" DATA USING RC-LOGIT SPECIFICATION:

heterogeneity        = randn(2,I);

solveforprices       = @(pr) (pr -(1./(alpha.*(1 - shares_RC(pr,x_jmt,xi_jmt,sigmaa,index,index2,index3)))) - mc_jmt);

tic
p_jmt                = fsolve(solveforprices,inits,opts);                  % This gives us equilibrium prices for RC logit-based simulation
toc

%For x & w normrnd specification, J=6,M=20,T=10 and I=50; sigmaa = [0.8,0.5]
% p_jmt = [7.67443191915855;6.12950388155064;8.02446478001840;5.89285476747259;7.68911320173416;5.66069120037535;7.81067111804373;7.27890566226072;8.74314585290272;5.05862418854567;8.29840095040236;7.53903631970598;8.10206002605544;7.80888431837698;6.39941584157297;6.78115367788026;8.79607316815312;8.19105149097831;8.61054613082556;8.19854192633817;7.50972691969239;5.40671588675675;6.48194188501898;5.24219939049747;6.38614293177602;6.33754366160461;8.99200291433414;6.84067460250420;8.25825739019037;7.46230221073094;7.28423929822776;9.22388912081064;6.34813245679924;6.60172045122237;6.56927974037759;5.17769005924901;8.05896936328786;6.31021660857133;7.10495604592522;5.65760208252052;7.79746197239877;5.55999799843909;7.66284095461281;7.47408285785279;6.24989364981634;5.73086297705867;7.56149963542695;7.48462381732990;5.63916219507667;7.85605503966615;6.92579446778786;6.87258345576368;6.64008763387170;7.45215866393165;6.29583462636585;8.09592882856306;6.75763955976264;6.54482509578801;6.25811084099934;7.73175729056688;8.09846180503942;5.89479427471687;8.94622559127877;7.90778582831211;7.49616023321068;8.91136018225880;7.72813293190884;8.13820643400715;8.05434143273969;6.37054852350938;6.21505602204611;7.54204498980953;6.30807913214907;8.63783445428403;5.48205781936421;7.28997246027905;10.3496156911829;7.64338363523018;5.82092822445083;7.06658949457311;6.54284853302278;6.33578193156845;7.54809158673637;7.84698928287154;5.02232696192373;5.57081908479468;6.50165562035989;6.93685809274404;5.56553057266989;5.57619759736870;4.08976347075488;7.52089359623493;8.00377332366384;8.67151381744333;5.25405554033176;5.65070629101708;7.75807625285745;7.19759793263736;6.95870197045287;5.72585423765378;5.43107328701799;10.0818040524083;6.06979397307491;7.93313116820271;3.91333363916097;4.99801649509434;5.75716241013647;7.11391015137765;9.00612770732128;10.0081973375233;5.82934365873044;5.61960453804486;7.22243355029082;7.84310603995747;5.67247051487321;8.24641213804713;7.27002383955775;8.63828163960840;7.05612468851807;4.92347609548819;8.14011953670915;5.99963437121527;6.11073510575214;7.58217172306193;7.83992351126589;8.19452849997371;6.98734381714893;4.50828068404420;7.50722740363362;6.78758535289361;8.35482046866490;7.87906922495035;7.52995179718977;7.11023184445277;7.79918615875749;7.07086165499621;6.77756127524373;6.75357050351979;9.02909891075017;5.54246894100886;7.95698721024864;9.14794364183550;5.77953285544303;8.43249594617637;7.60183183209094;6.75231278189029;6.84205459471749;6.56454053801464;6.27422812703490;8.99196682811417;9.36276477383350;7.29814873973091;5.94697343340311;5.76773963669573;6.52405420144303;5.79709912300721;4.04412110820607;5.63483984028816;8.30468591372742;5.12918095661614;8.69723839348111;6.80676902038057;5.98062294959415;7.94642218150371;7.22163347814302;7.06808009127967;5.56309329112407;3.88864971134973;6.13782686650294;7.33160341393555;7.36294966510655;4.99056459551615;8.64961821082587;8.19147067095723;6.18012913025580;5.84117377902905;6.44854695091825;6.88115414807088;7.05285206350688;7.56288816050407;8.16796711067906;4.34289182245972;6.35296552502970;7.05112463744703;6.00734014355787;6.20926892292204;7.87906110370212;7.51424728958272;7.16188301483091;7.30071298230082;5.53104289227843;6.39423550688361;7.16980723249384;6.04317000572055;7.78062743923461;7.08287905826362;7.45538246930037;6.58069508980304;7.18699233080907;7.38964325034129;5.71228724775489;8.62091434780626;4.99207298764539;8.63005727460254;7.94981786351016;6.08025953168185;9.25113589622479;8.08617855175219;7.32059096176614;6.20481254748328;6.47017056774601;8.08853604924641;7.48569733595167;6.53462790716883;10.3799597698843;9.46833579513613;8.54468128210772;8.44688682717765;7.64774995352367;5.43903743957419;6.54059595049313;9.19248876169337;6.96115980868389;8.76790232191323;8.56475885912082;6.08749248813811;6.81299291238454;6.97713741829004;8.51514522098166;6.05002471954325;6.15229006846066;7.37131706049258;7.76379044803965;6.69662334443485;4.56229187230866;8.68325002119190;7.16104197882751;5.99137642989007;7.40481654889676;6.80233438244988;5.92790275732066;7.48566537883927;4.65246051572809;5.93877220463521;6.45703514502825;7.12482810617321;7.99367886223288;8.31994455051614;8.37137583717306;8.51551482692381;4.49206711358952;8.48374646805675;7.89516105968750;8.08780325465252;6.28407562110464;6.73433443915140;6.53295632128087;7.12209487260601;7.92427832679933;6.77713836027246;4.55660159933717;8.34214061186135;6.99948597339456;8.44170662424432;7.45607200959755;5.53770702659634;6.93553061894153;7.43132774650261;6.85562362226862;7.69280423804333;7.28662894347203;5.31880224678874;6.63979663389078;8.10201802691771;6.82178398730579;6.12548742414094;5.89300288779834;5.09409514302014;7.39472685164024;5.69833830565597;7.76514515283682;7.46894236458841;8.24883026432418;4.81421520127855;7.01137609696388;6.33099731984374;9.05110024581488;7.08544171821311;9.48084987168136;6.35904967523034;6.00474777632706;8.49960409968962;7.89558936768931;5.16074736598448;3.36934522304694;7.48666191879586;6.80704774086885;8.54388612975483;7.83855778516396;7.42539898399078;8.13678262060636;6.07204663143837;5.99957265543042;6.75332978682483;5.57897778504071;8.80402294251221;6.53918058190590;4.64225285963292;5.95737648025895;6.29131094264319;6.01756378042163;7.53537912360426;8.02155903634448;7.75767078554295;7.00372637474546;7.26139766708563;6.16840953456631;7.59020191839660;6.53555099680177;6.12432324908399;6.64749674408158;5.92246378628303;5.61725578879854;5.97009990019232;8.67735190545602;7.61425662501012;6.98968903751440;9.40874886987958;6.93778484541198;8.37578944840700;7.06928397453923;5.86121734417791;6.94440321441992;5.96471213122029;6.40594228594842;6.39816112776383;8.09681914734655;5.68294233658437;6.87765041435738;5.45445158472171;7.03803519796039;8.79914452664939;7.09849213647514;6.86864036212971;6.58564161031757;7.75312849675120;8.44223553743581;6.12717076675756;7.51207224860070;8.50153841859780;9.22667711384869;6.89973816795289;7.91902014649776;6.77286639075835;5.16423803099220;6.93421358838184;5.67660057540906;6.43985455599860;7.33145979997456;7.84465016128761;7.30813085494376;4.95272066182265;6.85415355574982;6.23335115142366;6.68925695297497;9.37102888745102;6.16717723540035;7.85029655356603;7.76627023437983;4.88836860777706;7.54495688220240;6.18827915430474;7.35995005484965;6.75245552390201;8.36449202000655;8.55073012070886;6.81608928440440;8.88856548685960;5.76137017057357;7.20768490784378;6.42729244037760;7.51112011251812;9.05638396335623;5.59125671358878;7.19385268896318;8.18313265922352;4.94554136804003;9.02942807555532;7.32693006840965;5.24573572138344;6.58430249940438;6.69991881764537;7.63239162595697;6.58122601878931;7.28952121637710;6.07729986574598;8.47760497679179;7.86098577917750;5.68965903790080;4.39130016668125;6.88847598322210;5.11674300484256;6.95021177414845;9.97528527508916;6.64299278897554;5.79142984416941;7.14922348095168;8.62531740979202;8.71489596967782;7.93704150351439;9.52346203595529;9.54057356174177;5.60637139733246;6.64483693453334;7.47235575279386;7.78306235172423;7.34872517341158;6.01631855727510;5.42501698926781;8.03281158686121;6.34920443508245;6.20378592968636;5.02441894339846;5.76437380433947;7.27889413971953;7.68351393850204;8.64366861034859;8.68444177995401;6.60621773773491;8.22209920247342;9.80606755280782;7.71954939657182;8.10374941288176;6.51548315212401;8.50151810720183;5.49650979320106;6.81635784509309;6.77389326551176;7.00407822837991;6.78576867759389;4.86417256169389;7.08503165938632;6.45581016449276;8.27566860191768;8.35519919619347;8.27339313592574;8.54134331495296;5.81271449430335;8.60242238261429;6.55757687278802;6.86801053185164;6.55679118647575;6.58606083690982;5.75068213435076;9.21153757856873;6.59563689907060;6.21995015545831;6.59459579115631;7.10915348378859;8.03929291008659;6.88944058737770;6.66501922226678;6.59836731879586;9.20353316886087;7.26249984554332;5.67880041493605;9.62806640555403;5.87337950583586;7.88573768580115;8.34520742498695;7.53202459104814;8.65944605400413;6.08123117547017;8.45661063008438;4.45048323002418;4.70010245653364;8.38775169150249;7.20284810733732;6.17475687826012;8.01675492324752;4.51907714109953;6.47871818290299;4.92597050763736;7.14685355786639;7.88660302155752;5.92876065031909;6.08735137721942;7.72381764501537;6.99563835640777;6.59084903752411;7.21299294685876;8.31427827101830;7.15771131786513;7.30070008239722;7.97576713574661;6.01452315074191;6.69948016171046;6.28749663038633;7.18487902078962;5.80753814083806;7.09117065796173;6.60104426332895;6.88165504002235;7.90205854755554;6.74589601955728;9.71030756156424;8.48631975652299;7.47388405507398;5.18419566840387;5.96295548262643;7.89611283580947;5.42958503903909;8.75666775676219;7.88325667014939;7.08334462124699;6.76734803343014;6.79814384056628;7.35331690713890;5.93888135131140;6.96756618092815;7.64778933110711;8.76665220471603;5.06592036594782;8.69508888757878;5.06309223431716;6.10799789820939;7.46219331827272;7.82439848363796;5.84351589032722;6.40865128703540;6.55747194384222;4.83547182168914;8.91166596519070;6.63282726314361;6.63445856174647;9.49154309272837;8.25277889379573;6.58924675179683;7.51255716695835;7.07737138464572;5.48780667995268;6.91887597038431;7.69224923232288;5.79973874060621;7.12140338498345;8.30519258835713;7.04739488317563;6.36715678330845;7.16846292889555;7.93374541999037;7.69295683430432;7.94950248863719;6.82339184443794;7.75307204692525;6.00111827059954;9.15654283082976;7.43924142544966;5.41089323879723;8.73006936578367;5.90451555300456;5.21167458493396;6.84088045180846;7.76706916518214;6.78018072279191;5.96538640146799;8.63968192169765;6.70364397787957;7.36859313874519;6.89196493731010;6.79941390604564;6.56777717139429;7.80878916203463;8.49520936464570;5.67582823092154;6.86592599014964;6.94565419908665;7.73259324557287;6.84918376054048;9.19064818568871;5.92495331672896;8.04035828795804;6.38897356397016;6.53955959506775;7.98437167765054;6.31598791726717;5.59114852617234;8.68584091534026;7.11876884731808;6.01119041691596;8.68726066730232;6.27282513407122;6.27875948774288;7.26065763275547;7.48444472539821;6.44760709342585;8.04900062172374;6.71472231137794;7.52770052593653;5.06567635640864;7.72446637956885;9.65119799903432;6.26821908291708;8.95611053205558;7.60231622372697;5.48253063012766;6.97325156897915;6.62049392743669;9.57065448557883;6.70803926257361;6.82134505017610;6.74540758084658;7.04511812015348;7.80854771032611;6.84439512791145;6.50774224037509;7.69872146536736;6.18458634016116;8.67253587143923;7.02979670773427;7.77626612957330;8.16698552157443;6.74312119285782;6.92123837152908;7.20587534302800;6.54229551299652;8.44717979863094;7.86777310105341;5.24476658929446;7.69138798866760;6.25495641762001;9.58015671791944;5.24762557275179;8.82882650590507;7.30236915907177;2.96445507610607;7.63840618223585;8.22611935483030;8.49495175371651;6.48947581337265;7.28545024575095;8.30476681848545;7.06878671423554;6.61381828135812;7.05178555113011;7.83149517346738;6.27882963242763;7.70291422143161;7.26208963849877;7.47222602611795;7.17578362433613;5.30854353241879;5.07703008398693;5.85867785896099;6.16933895595494;4.18848218308760;7.50870580546546;8.58431665569580;7.00736677017407;8.94340504417042;7.11876497781755;7.27798752910237;5.55429828398846;10.3387897991029;6.29919543602792;9.33700258240443;6.75601262349762;6.17780123354828;7.00153382331185;5.41685914459929;5.37867428299807;6.32467319629960;6.09656445159742;8.14515307394763;7.16712047256322;6.93686461440576;6.00995776856339;9.21415141480945;5.97483626660250;7.12692231969733;6.89579404236627;6.67018749953077;7.73494982816370;6.04244003793759;6.72984864931905;5.67131588060668;7.12352510056397;9.00499994946931;6.72699165747676;8.71104905837105;7.56437056251806;10.2554412590946;6.32084725335390;7.18305055183426;6.42278558520660;6.06189843580194;7.57331600281262;8.68362799576296;6.47084009521667;6.23287595811354;6.43193985253352;6.65790582939211;5.73846264062252;6.14302213786675;7.41709586743033;7.82140750855626;6.63545803659679;6.81788167243471;5.34115818190253;5.72080619936883;7.42049708024851;7.28424739243398;9.24675401434049;5.67195258101794;6.55887422455821;7.86841325236575;7.04266708851704;7.10100507376959;10.1343610011569;5.93840231720054;6.61198839149686;5.91491939355004;4.33283673419017;8.51481488352168;9.11805085319866;6.49572654919403;7.35841434138648;5.67126345561329;7.52605646535552;8.22578696336095;4.19493877476549;4.23062253738546;6.80918142491461;7.49641510341246;8.27722338945997;8.02151667569346;7.25111594871850;5.27498561250637;7.21323469321029;7.31696776908024;7.56702328000294;8.05124203908301;7.48212766707351;8.41300192981624;7.93327739414896;4.95575340347999;7.29827023663792;6.90466890267105;6.31391253034680;6.06880298867931;5.90379601891836;8.46898429813667;6.29150672766572;3.66887794814287;6.41072883981462;4.95502164733854;8.37398211068463;5.33585007450907;7.37076167143352;7.46301660971866;7.17307852097249;6.40594493191623;4.81160495596393;7.48039395063716;7.19048300582161;8.62254916195349;5.08332366681306;4.07384540952114;5.89185252474589;7.55125292992170;7.13285988088585;8.85611901947813;8.32658834292343;5.37178425917223;8.76617060721610;9.54755986007038;5.56908741589235;6.71510506404605;7.24610529415810;5.24317171048336;6.55655216626147;4.94554409863822;7.33511239689627;7.01871834256083;6.63011102960966;7.18487890538504;9.58126357080764;7.25106728195153;8.60946532018167;6.22412087640536;4.80662243469160;6.47922607435289;7.12029584570820;6.65701199676701;6.98547490496416;7.17709319076593;6.70522109595990;7.61979725920615;5.82207058082835;7.92068048031383;7.57311781452848;8.15041081418966;7.87447200821838;8.94617146091531;8.29783949821745;5.69236998963892;5.00092408601056;5.74432918956882;7.43223305716043;5.36218710450591;9.00949111701286;6.35964555101736;6.41633149785717;5.73727966431403;9.24526948589229;8.60082525410036;6.60994790097692;6.88226466086884;6.99892480244875;7.31950488530257;8.61851821781581;8.89581682049256;8.74786427590733;6.71397831008486;5.48375881901128;7.60320159972043;7.96720351368365;7.57790629748321;5.78059008056799;6.85512422558783;7.96195243515266;6.94319942286522;6.71619658267447;6.89243876487965;8.30184379160216;8.33897246595858;6.97931168152756;7.79954453816865;8.72837692360691;6.49024394382148;6.61714337117529;7.66904122555099;9.18416655882323;7.62394760389683;6.44783295618564;5.65528426427712;6.75195550013448;6.17537079044850;8.36472186546153;7.85862588799416;5.21447260177227;3.19572910133205;9.19624869019928;7.73535268127835;8.53010506515951;7.95465792149335;6.99084721495224;8.96797707219472;8.64321335849517;6.05888349030354;6.90367045368191;6.37954209382006;7.87479825822747;7.62008149727915;7.45047462181082;7.05280683629319;7.28098845772571;6.73393716795983;7.69007081579758;7.45868337622303;7.86313642474076;8.57782331321201;5.12896389657764;5.67872741122979;6.09040431579650;7.92900982971411;6.10758790225273;5.99441544842315;6.87350533288029;7.26383696674842;8.04631678485744;6.64177707059896;8.12799918348837;4.65192482569282;7.03464763215942;7.97840868608703;4.90383492239556;6.82938306224169;8.20081558313222;5.56428697640722;6.62658566975266;5.19902214863265;8.24527313809031;5.72146303437537;4.70357793272615;8.32309752265474;5.77473737183655;7.39484125446893;6.70392245404385;6.57177799869563;7.25045509166327;6.85389540781601;6.46730756859979;6.87162556910834;7.77839508601387;6.01190257239673;6.08995544356692;10.2342583898861;6.01023340475511;6.85014786456511;8.53362806820486;5.55023799102329;7.12747387111207;7.40137288706429;5.59978592323416;8.22853202918027;8.80342602823114;8.16887830909051;6.75980283889519;6.46434872936207;6.17380938671860;7.32361006957728;6.92394769958563;7.72586686484596;4.75092167538061;9.31538502100016;5.68409869418090;8.73438339757027;6.19791016958228;6.17267623612128;9.31123922886128;6.17661069299348;7.37098483885433;6.74036444801918;7.27359103670418;6.92429159312953;6.11187656932757;10.2470841792414;7.65889686283884;8.11700720348448;6.02854469619530;7.21865600946409;6.87380092630262;7.29451661516433;7.05041254847197;7.08522867734311;4.87128120300426;6.17017120065737;6.02459949034249;8.75485979136180;6.11501582788915;8.94002499719456;6.61857044159228;7.18073649365559;8.37739670599471;7.11151087004338;5.81905762465439;6.32172722458134;5.63991539149471;6.13517002685815;6.56891281308550;5.39030486942775;9.04421225179061;4.85954867081133;6.43339329313857;6.26264296565059;6.28270708940277;7.65042564117940;6.68160355402560;8.29781781470250;6.27448502150344;8.66596501458361;7.57121659760586;5.35720101477885;7.87143501484415;4.22816213872180;6.98489303697915;9.06304614992196;6.29029683472153;9.07320120027169;7.44627663245946;6.61880140552335;8.57584578674552;7.25621226707293;8.10124739461709;5.50898648130556;6.19312759478015;7.61305096676329;5.81855164320400;7.32258755957281;5.49807879698191;6.78308990075626;4.96299913759499;6.48355835763971;6.20572159767594;6.29522480745909;8.33906101188417;6.57245987826376;5.11579826450676;4.97726024938460];

%For x& w unifrnd specification (-2:2 for all x and 0:1 for all w), J=6,M=20,T=10 and I=50 ;sigmaa = [0.8,0.5]
% p_jmt = [6.35711877334859;7.38301319783463;6.50021996424051;6.10343278212187;6.82824686011333;5.76807912528747;7.32946010096384;6.05453592524799;5.98828091796574;7.44283290653184;6.71162580273060;5.53820479496457;5.74210038572146;5.17351403979059;7.01831208864332;5.62648499327546;6.77702945465840;8.01321322697924;7.86669622364882;7.34325382305569;4.74870652837988;7.58099546074900;7.81348782755668;6.71015758729670;9.02362099143875;6.03336678052059;9.16598845566641;5.17817699035915;6.13314470843930;4.67019418561265;7.04026957850528;6.66851187874604;6.09317846784890;4.85090397657322;3.69513935522842;5.27875486864684;4.49031654513174;7.38418556977204;7.35662113058714;4.37987829343127;4.78942315219981;7.31311083572270;7.25257525174750;7.33885779924119;7.91935311899796;5.66304651758501;6.29691950810162;4.78378580968498;7.71244529572821;7.60029312587818;5.52359493084229;6.83636793359582;5.68387392635141;6.94985617135375;7.51934237479681;7.94313162763458;6.79704063865952;6.56048272351821;5.78675285534883;5.89877475219977;7.44444750494189;5.89242268276479;4.59613921775268;5.63674918079472;8.00571335491894;6.75941571520882;5.74437312325094;7.02691747709765;6.93591534487575;7.41069173365132;6.40702152270741;8.91349734917308;7.99048471789048;4.14455297858128;5.07247965582438;6.86540080585296;6.87041978578696;6.24338913133135;5.64127641485117;6.09469631295282;5.20724993865474;8.63482295664983;6.24898668743193;8.37497076197530;6.42815172357473;7.04051587268188;5.40038766494899;5.55314134410229;7.44596780511977;7.07323504928799;5.47509796174700;7.16349395720479;5.93566879334731;7.89188340035151;4.99359687073980;7.82208650841466;4.98512743018659;6.76515773351172;4.57171896186334;6.23440189391835;5.86433003838824;7.67357983776537;6.14134648088469;6.86952461755670;5.58800916677628;5.75616505804264;6.99645107458205;6.61029544737272;7.00183197551283;7.76610151626793;5.18389054706014;5.50228902991495;7.27048984249488;6.78162204497326;6.19221261315894;5.86126894432261;6.36795124818154;6.26059741021000;8.09064110689378;6.29501188367473;7.60370152807344;7.57425533620129;8.25002895471822;8.32288407839558;6.64611745611118;5.22181585123212;6.04875560943776;5.85878235334050;4.82632394275966;6.31208355204127;8.34992811040673;5.27835424290118;6.51550910801514;6.50977537085716;8.64195466530237;6.34650941430768;6.29170090024529;5.30044629357704;5.97962558033529;7.41423128016696;6.94843856780663;6.71698443453887;6.72297879842398;5.69599765132464;7.09461917381338;5.69000971333200;7.42329846698953;6.79554283985583;8.26234403585483;5.21432063396403;6.35574621147813;6.37837302502932;7.12490213748044;7.00641084214642;5.35079358193058;6.60627129314328;8.21896197455632;8.42231124565834;6.47026117982341;7.79685043357867;6.01788011138488;5.62318964554896;6.49477320188058;4.81480382234350;5.81343465069301;5.74189400610885;8.62495138466721;6.86698536640164;8.55684212239789;6.47974293521971;6.77908833209823;6.91476759161602;5.73662341955116;6.61305801452788;6.10052692437579;5.18379287298057;7.49511562720060;6.27020216190240;6.15165397613283;5.81022117445290;7.00821078746144;5.97326361561101;6.90291352010421;7.31384352813875;6.73803715678214;5.93313967450267;6.07238915517917;7.80437538660680;4.98246203567901;7.04709571725058;7.18928790216345;7.17975893799195;6.61800954541725;6.90770239940647;5.32659440264402;6.73270033161903;7.47210870450952;6.85610424824403;5.92909123011640;5.92701750071314;6.66319792798010;6.85368056430419;8.24734242387216;6.71818495572653;5.95010976275031;8.05307063572524;7.87214701091520;7.08467175101989;8.19129016371594;6.28073916123745;6.25772082888360;7.30737883000716;5.45988343366266;6.96933678844971;5.29304353739177;7.11519653970586;9.08268355840189;6.25639475618449;5.90890120322553;8.16246756714028;6.14608856720820;5.72278525530827;6.55272815541473;7.20793284619835;5.20083623626434;6.03331374589098;6.61015663295471;6.32085148669423;5.14783240940916;4.06719417475825;4.55509561447138;6.77050128268015;6.72352054115381;7.30859010230234;5.61753784130871;3.79148286478134;6.98846004965857;6.77132220647638;6.33394538294943;6.12876575920722;6.28734238402905;8.89429118768373;6.17988215229336;7.38402692628025;4.39977671989160;5.23676874150462;5.63186951514874;6.53219649178954;7.32781373010843;8.82047448285782;4.85654031719629;4.50429942016490;5.82993037646989;5.58916712461494;5.09121537209760;7.62929824091403;5.92770293730445;6.41669969119639;6.64700031830059;5.05946791942389;6.90060216178894;6.93102290071318;5.24418336420000;6.22441360952572;6.54650369766986;7.86990067308024;6.08887936873613;5.52110508540924;7.33950510049307;6.05983366662352;8.75373281197311;6.83218228401494;7.55259988411917;5.95168624128024;5.84363584728002;6.66675594986399;5.51574997956666;5.78660540690113;7.68340334855067;5.98282462188378;6.39282806527663;8.47100567425977;6.21735992090757;6.53177322882427;7.42624063178234;6.60827880246328;6.62359683617184;6.28627261064271;6.54270771550054;8.21269436928602;8.44418342507792;7.16780566664780;6.19291615365053;6.57078038624605;6.27049572280265;6.74840692794579;4.51470730713500;5.35345729237721;6.19999887823061;5.89462651874029;7.51116051987992;4.18763091520648;5.92473226879751;7.17842411601167;7.16150308531438;6.24363071014904;6.66194524874734;4.40109536689469;6.14174504830428;7.00672308025943;5.96592195736174;6.73253717338433;7.35054575328115;7.70967405537839;6.28418774392047;6.84592030316889;7.07011841561640;6.24385003560200;7.46312762936426;6.28778528106605;8.15548628211643;6.70855697368816;6.49828595618744;5.73134725395265;5.53567756443413;5.09267887680128;8.23493037578261;5.95156213876457;6.28640145792456;6.32975947253620;5.77396385618923;5.99899232217740;8.04170109569158;6.97068708446440;7.05597979013733;7.59356176409804;7.85810395106742;6.41133201277599;5.87267796710949;6.70342060040833;6.30942665581887;7.84865083463105;5.03373873666982;7.26930130257646;7.89824919350921;5.48355790501739;8.47345011532353;6.97199768184624;6.43547644323769;6.61363309709051;6.59370622701545;7.26595674789665;5.95935362053672;6.19831769546816;9.55108515010502;8.22903616888018;7.17326639749031;7.93390756865057;6.50527049783138;5.00144599566325;5.82394465305154;8.64551207067189;7.33687646938274;8.36328822939072;7.63316492191603;6.53747905350429;6.30735258330364;6.41250612483980;7.49787392575991;6.29746953418508;5.43996503152901;7.64007277897966;6.36750285543281;5.18177705034392;4.66947840839227;6.30576943505961;6.40593379462476;6.29311369243577;6.21310878388031;6.35632332487749;5.16436527054984;6.18484799294934;3.79246264418818;6.23206482514105;6.19627134530618;7.18856692586666;6.16408580513861;7.48803348825494;7.52808882747785;6.97722924565992;6.22291563522947;7.51171576599917;7.80983992693541;7.87623265662661;5.99016178823075;5.27616777193681;5.08303764376173;6.34315580405139;7.23054198787204;6.15205760084984;4.78800420240083;7.55985488230781;6.21367246266005;7.65420044539904;7.44461093081933;5.59371411659117;7.08089708296838;7.31825580511732;6.28212796738251;4.94953211009376;6.74792912087619;5.38126332183514;5.90797856074024;8.01287185398669;5.86105584058440;7.36841897183062;5.70180612502372;5.04042106009169;5.50219362204602;5.30210914692041;7.45025231415218;5.80586181453586;7.33746816587838;3.86190999359039;6.36329626850395;6.07831472407195;7.78053307519453;6.97748764882212;8.46111439727867;6.48681194665800;6.23320854378594;7.20310584487815;8.05050678790465;5.70067442552722;3.59006174306233;6.50989029922071;6.67338474423511;7.94419009427370;6.13450670688522;6.72213388034128;7.23756160594956;5.69617195944265;5.16305469484323;5.77175607854064;4.86331017906255;6.89898590030856;5.77229851999514;5.24092360477821;6.29568580966157;6.85261703573885;6.24996710579724;6.98560881338876;6.94058568775571;7.07771980490246;6.14065112173811;7.36984297313306;5.94811257818615;8.27791530160273;5.73906912500574;4.79715030091560;5.52218977885916;6.24742701763275;5.79033116677652;4.93332567258526;8.76682954047726;6.74905269632045;5.42277437086994;7.89612206744195;4.83885912625059;7.97106074408801;6.51255177362713;5.86627105383996;7.42995462543180;6.06113913344366;6.38199025401794;7.10677324833372;6.67400538285433;5.66250715618872;4.78673619269770;5.19047074712102;7.26666403081261;7.15119954890180;6.15844295914746;7.53611662863421;6.92416044551043;7.32700762066848;7.96201833316568;5.74258337459608;6.32082691197941;6.75419100189439;8.18214445294563;6.81602722577494;6.07135332142998;6.35628499964400;5.18060633992588;6.15649581475139;6.14647674463659;6.88897474065363;5.95817411969282;8.26772142083454;6.40674490178157;5.76585097118457;6.77151795998000;5.84823103466735;6.50587502366876;8.71502415439433;6.85875956280668;6.96552128743634;6.90517572994222;5.88750305353367;7.80089309809422;5.98757195749624;6.76447093866228;5.49598576297801;8.26829679897932;7.49139399069011;5.49425927794671;8.15868474622642;6.13115349761408;6.53809516386479;6.71716563573071;6.90267775146309;8.99037798994936;5.31653097305850;5.24929476205446;8.01314486718739;5.57134725535147;6.69380683912230;8.55391355108181;4.34024325396533;6.54419986806487;5.73868350930992;7.24440405868872;5.49035358148159;6.93526063120705;5.92948708242800;8.03706972403986;6.85846373975259;4.98182042581784;5.45606150171358;6.55673438527364;5.20638600758233;7.79148274109167;8.43889086595720;7.70116653234067;5.38189495598027;6.79966423136994;8.06781360007929;7.47508783783196;7.29212711394785;7.50157932513778;7.74675412229556;6.96936110806260;6.84286482518552;5.84180285971210;6.42230191684544;6.71277044971464;5.52255566996358;5.53431749131454;7.41175761676010;6.25349329087827;6.45013288523714;5.08318435604963;4.95792560350691;7.33269736051210;5.97774941810626;7.33577451202355;8.41057295909401;6.14442318051127;7.26938354981930;9.91011431252445;6.14036035556586;7.14121754036459;6.86184348510734;8.10662799597562;6.06992793904148;6.38511068953154;6.76130583984561;7.01808993944928;5.73152245439378;4.26650247434961;5.40196527557126;5.57032191434919;7.52115368112748;6.95429309809209;6.75317463416455;7.12063458009332;5.84167755727803;7.04111670060360;6.19566535878997;6.68338389337922;6.18035752250083;8.17328869002878;4.97886739852619;8.95222095766703;6.60848720957012;4.85938272498859;5.52598603081663;6.69775982699834;8.24276235809347;5.42003569557261;7.37496032472393;5.84832425890005;7.30236388986769;5.86381472610150;5.37951998324644;9.29917496320606;6.47020477585528;7.51561830690126;7.36909786376785;6.35451714782411;7.86436174279754;6.60582014717405;7.33668212352576;4.89824858737564;4.59824974511398;7.49037063166811;6.14083593317449;5.90911176703137;7.50710379088141;4.42203873609511;5.45431966766282;5.95700369898525;6.94669383756299;6.86359390532324;4.79422569432488;6.08580933515442;5.89257398826751;7.11914746921604;6.06377836814558;5.53224616697557;7.29728969197968;7.19391715361269;7.05140067251244;7.04768962260341;5.36633845232136;5.66994306781143;5.78451996361382;6.91141768221785;6.99390652504880;7.31835605459592;7.12952244899651;7.65131049291970;5.86041855598626;6.13316142279485;9.32303950681973;8.00529270427557;5.78488100892876;4.51247531248082;6.20405821918656;6.00799808718172;4.70098048822228;8.10795219420352;7.80019063568156;6.68992221089946;6.23897881697285;6.86820405967558;7.04717245117413;6.55951768859743;5.63309732344050;6.74267075049936;8.19304392856803;4.92921809336356;7.81849673006049;5.39255478644198;6.16854562343817;7.24567657064241;7.38362644295930;5.61176944247515;6.43144170516371;6.05224859385363;5.43293226571602;7.26037427537872;5.96646855985386;6.32866292596637;8.31022831302047;7.44581244591025;6.66699281683754;6.80650610898500;6.59245516170467;5.09290652379589;7.29149961532556;6.95839132318441;6.97482484014325;7.46704648411218;6.54494402577376;6.21932346693604;5.36791310432136;7.20060263623422;7.69592843087816;6.88356614601648;7.22862939349856;6.37248036920238;5.87995661027342;6.78313618757648;7.47277941587166;7.54139320940750;5.94274186456627;6.91324450377332;6.17875705991183;6.79582731618629;6.75352271272654;6.93452563491320;5.79074438698642;5.73978005262078;6.92959553657870;6.31806590247347;7.24347755919032;7.39886533639158;6.93218038122464;6.54784139362197;7.21558591566837;7.25429076047713;6.07282881128169;6.96122459925329;6.46915273643145;6.88393146602467;5.19628409066239;7.09192963341609;6.17876323057335;8.66569348564489;5.52829696022995;6.66843797908079;7.91559892450233;5.67466772492324;7.11664167360896;7.58352524209220;6.61258686352984;6.02597179886770;7.13929188860845;5.16442232352878;7.30859269374606;6.29503851794324;6.43606567546996;5.57166268896347;6.48138662278225;5.76963601044209;5.86108156980979;4.26468513722648;7.12234128114059;8.31363902138158;5.62802261205293;8.26624710784608;6.38665733778573;6.21179917605537;7.03640324217603;6.65403097862619;7.37374692284954;5.42724587163837;6.46453367592015;6.78932747967204;7.44549376768577;6.74631815806703;5.78326218848198;5.77249695125193;7.23592992741750;5.07180574091729;8.10000261089517;5.87781402761511;7.02477730121816;8.42897369224483;6.05478959104562;5.77919785366251;7.40418009214368;6.94643048451199;6.61327111552803;6.43862639311497;5.60441903846131;7.43248099817748;5.75134484763205;7.35186165140335;5.34121179352224;7.89586335625132;6.66874365765450;3.88757953861530;6.70818295344755;8.55000634974420;6.43910354139165;6.13552326698898;6.26967806299119;8.10785151579498;7.60949192926660;6.95859379937801;6.64880907360725;7.06139524817095;6.08168757574206;7.62090558853126;6.82341475267512;6.86807175225361;7.20227560498161;5.16112052171086;5.85573283177742;5.16500889052570;6.58461157374899;3.91835424441486;6.13878297486312;8.05099835304150;6.65147515894933;8.12656359516758;6.64394446776828;6.65947016914418;4.79485200471745;9.42907623051094;7.20900351213842;7.34330969731578;6.76867613111521;6.88059142904323;5.84695173636259;4.00988537300259;5.71845574690140;6.21712290692243;5.89501126584551;7.17799298735184;6.80873838974800;6.31390329897633;5.41264920080211;7.48520681811349;6.37048861880024;7.33140382257014;7.38085667019339;6.15070433419333;6.60105983535484;6.45066688301478;6.41557299513480;5.26488987742197;6.42934169449873;7.55420607046212;6.54484171245151;7.04437121070497;7.25973501654383;9.72494423705776;6.23270279038345;6.95897129088524;6.10389354810669;5.68813401679570;6.37417582286577;7.13121635461624;5.83553995575690;6.53915565967135;5.67416472420319;6.41100973137897;5.69426913037351;5.50300650905477;5.25440232729794;7.49210870351279;5.88032407706288;6.51828081391202;6.07028555673505;4.09008905582740;6.86798721761125;7.01834903188460;7.22273163143511;4.87644512518826;6.83509500683439;6.95105483427636;6.60893124023865;5.84631183071358;7.74683913775086;5.86322711812341;6.82399919254719;7.24067418073012;4.54532417945716;6.61807993678143;8.02775001808197;5.99184708582565;6.64110631857317;4.96801106738167;6.64005527652713;7.45801848959243;5.57720749975357;5.60784863260369;5.92380872713172;6.57598645050427;7.48932413190016;6.52487291962372;6.83794330248270;6.03717872667496;6.67423331804557;7.12385411948771;5.88595993357992;6.96332657979260;6.85024510178812;7.59440802380678;8.22094979789813;4.38140118115357;7.99421209188417;6.15725209847997;4.77898768191826;5.70468625615385;5.81705034413203;6.18123137964783;5.75962375523590;5.59519834649916;5.57599061942268;4.88079178760079;7.27072708471113;6.09196860558795;7.19258576276956;7.18515805569786;6.22144621166324;5.56769458482083;4.77646766519831;7.39250631164037;6.97819777931517;7.68245138735971;5.93385576564062;5.13916578216529;5.46302236310608;6.41458052711073;6.36270428069184;8.49558317915306;6.77358893253547;5.33764897019725;8.19530235161208;7.50158974805054;5.26774327828409;7.08116218204155;6.82422057547184;6.26365897310853;4.79681699359548;5.43293873790568;6.81521375505266;5.26815589838918;6.13061258726066;7.29032417869293;9.11235936864458;6.93140743578812;6.98201964964654;5.70404800081265;4.49199346664999;5.62414910415138;7.34437339197445;6.51837536517742;6.35459339223887;7.82003636564915;8.23600272713127;6.95632130292558;6.25197918387684;7.07026116470043;7.71174458511205;6.66705789737770;7.67732588049846;7.72356821540138;6.68051575624324;4.96297397303100;4.97409235620615;5.65405926203581;7.52368493768399;5.67614552041762;8.69016448340106;7.18211713795009;6.95101723432384;6.21528551529612;7.57705444575241;7.94535876692604;7.20838340842791;6.13247586442343;5.63578460536360;5.96247048665658;7.15521441550660;7.50893023470232;7.99399068422387;8.08780784813110;5.31660869054128;7.94025019565485;6.78238866213292;5.60023719449673;6.63421770184618;6.26355200591784;6.68611751132526;6.32281455625862;6.11489492661065;6.32841953189076;8.02628825069250;7.57471534701102;7.17767719232034;6.96267439718381;7.76063998956888;6.04208538187186;6.28949625844484;6.36818089812694;7.95002817021109;7.06168755648440;6.23599580549557;6.08898757088832;6.27386889369410;4.82956643953538;7.51307130030451;6.79356038985538;5.80677450734836;4.59522269423162;7.57607006423717;6.80539324482470;7.29064567195177;6.63065983957095;6.60733671815574;7.78792577864220;6.91507306550518;5.21773878279771];

%For x &w unifrnd specification (all between 0:1), J =6 , M=20, T=10 and I=100; sigmaa = [0.8,0.5]
% p_jmt = [6.23843811032387;7.40344776895019;6.49678366336718;6.10595825223596;6.82837575001361;5.82441934815969;7.38859270927133;6.04950658241571;5.57450989224402;7.44283312305263;6.71015502975350;5.06523899600085;5.74255907496665;5.17278581081269;7.01842804784714;5.63618569706918;6.65048261672302;8.01341505463997;7.86108985002935;7.34326971402951;4.79305152011124;7.48360575085855;7.77531784364387;6.71322938786548;9.02360584522760;6.03031533697434;9.17323118760839;5.17568061378920;6.13337004931414;4.63096271245495;7.04251514281246;6.77278382768850;6.09499096712058;4.92699773717379;3.68141036395864;5.27676352014340;4.80013829759610;7.37955780352757;7.35662705776693;4.38157062894496;4.79912406116714;6.90973521634592;7.25247111803211;7.33897123330491;7.91938126052479;5.67253781672631;6.28696719313200;4.78848699730233;7.71166023195934;7.60039232948658;5.54286234353828;6.71983565053965;5.68526725718851;6.95010705862037;7.51936495617226;7.87797591407361;6.84134617699588;6.56121871358675;5.79679912530301;5.89820243036212;7.44545399017269;6.13302159867351;4.59980456812137;5.46784139577489;8.00550344638526;6.75918321487665;5.81160501150057;7.02694886347233;6.93606803323875;7.41017861764300;6.40788363163998;8.89478688980644;7.99075298103755;4.13036238327231;5.08574513113347;6.90202995102739;6.97535963985815;6.00488475403469;5.64804360159681;6.09476573287959;5.16686015116809;8.64796872920799;6.24945260941408;8.37032404045451;6.42815579818556;7.03895474892166;5.40163595093546;5.55483989197647;7.44593577280928;7.07323933383820;5.47931560585928;7.24932296731531;5.88016839628329;7.87225214334049;4.99367897378662;7.82199693017854;5.08085181324128;6.76529802606264;4.57205365122332;6.23461128200411;5.61309834112195;7.70020784215117;6.15168023036994;6.87099419978261;5.58803330206321;5.80724459882528;7.21094024448829;6.60945272200209;6.81965317748001;7.76611534508296;5.19206890595953;5.92561211382688;7.10923836980149;6.78168475429900;6.19238401835993;5.89640586744531;5.48451677434452;6.26070787107925;8.09080970672861;6.29548494404776;7.38688600368991;7.72576429015217;8.24810235632813;8.31746856546480;6.64348429204710;5.22638149320756;6.23930934422911;5.85953841565657;4.58475435752959;6.31150195909227;8.21968354860012;5.96840830526135;6.51606027052303;6.51303392401356;8.64195503109367;6.20781606082896;6.34509037775002;5.30332139858635;5.97969309142671;7.39741818932306;6.94200159366503;7.07119338440429;6.72190957965323;5.69762043519110;7.09479482892465;5.70863916156099;7.48256238568495;6.79631965286665;8.26268721210849;5.21504873394918;6.35937808441614;6.10183953058618;7.10446463754056;7.00671205590866;5.35224478246404;6.61031632188581;8.06609072579618;8.42239756817723;6.47042473292072;7.79404576673864;6.02644531312984;5.92045316681443;6.44481243582598;4.87153933653013;5.81364977599330;5.44597445932581;8.63152646570296;6.86741684929389;8.55685317352759;6.47974584999665;6.78038754559230;6.66371449116501;5.73678142493321;6.61313311933204;6.10063775917561;4.99690756782923;7.54573384701278;6.27500823778963;6.16214854015848;5.81071884740326;7.01481758135985;5.85930836144607;6.90317486227842;7.31410924105220;6.73808199528413;5.96173253495277;6.07455381035776;7.80111743914536;4.98458248474006;6.98991849018214;7.12906023970092;7.35996931746505;6.61977636570191;6.90999563046764;5.32715143454964;6.73398002417186;7.51605709685020;6.78951325539217;5.90484260978431;5.92705649967185;6.66368982266356;6.49508760147816;8.24737903779277;6.71855182743689;5.93698832809404;8.05015333156776;7.82683606573352;7.08957016578508;8.19172502038003;6.28089214189077;6.26646380688921;7.34334999972887;5.46250446318883;6.94508359713818;5.29314993332840;7.11641433100282;9.08663955649909;6.25949704205112;5.92749271878440;8.16247274347312;5.67359908341473;5.93808493138937;6.55415719731699;7.20584787103493;5.14462995337835;6.04293747205342;6.65486352377940;6.32127741036303;5.15484924491195;3.99885228209444;4.64899576365209;6.81655240769646;6.71254898847557;7.30906061910177;5.61754514699823;3.87280752823884;6.99266137546610;6.77143927064704;6.33398170252788;6.12922830981017;6.30217993023056;8.90032821778589;6.18551905719181;7.20473533074286;4.39720780442885;5.23787353658170;5.75606377830368;6.53279138093186;7.32793935352509;8.82031257605514;4.86500360033882;4.64399226411298;5.83107209023502;5.58908270295162;5.09130284874747;7.63060547934294;5.97162363181429;6.41834456149446;6.61001562195925;5.05974719588099;6.70618924905102;6.97723504498756;5.24956752934877;6.22468804067670;6.54651213372902;7.87007405702342;6.09567275108807;5.52117015480117;7.33970337829235;6.05984688391050;8.75194582857324;6.85784587643380;7.55221272807458;5.94468874546545;5.82743623222942;6.12325784131331;5.77848002045079;5.79636323282491;7.68362523211018;5.98286378262879;6.34868060203471;8.47194216699393;6.22538303424916;6.52644868783303;7.42624565316382;6.60936476652462;6.57781836150564;6.28234870769535;6.54336246232712;8.21271291172356;8.44533722691010;7.03688225075307;6.19363811097945;6.57184775049216;6.27049836655670;6.63571609404911;4.67970633306874;5.35419413391330;6.20004852529906;5.89467716770998;7.30014930950813;5.08561573030562;5.93690581734663;7.17801467278370;7.16151966863166;6.27423957826278;6.35624489387459;4.53935710302244;6.14205487380134;7.00674129921309;5.97031534236450;6.04791094623973;7.35178541590274;7.70973126267774;6.28439165297424;6.85346866016392;6.68193589396876;6.24552098159342;7.46337579338811;6.28890928320491;8.15772853473379;6.17639426663301;6.48608848574263;5.73934974681802;5.53685146977748;5.26263428152552;8.23973548650175;5.92500710055074;6.28620738535631;6.32999378373867;6.30288121959218;6.02167707932739;7.80599294925777;6.97429294153258;7.05599960269294;7.59947132807495;7.87995603782121;6.41244850825550;5.87876573415092;6.60031947632756;6.15125092295738;7.88747015644725;5.12890609033094;7.27011074312720;7.89826834441965;5.51546743073032;8.38258616240496;6.97350864524667;6.35261757342032;6.61368416763325;6.54982399736358;7.22419099867422;5.97165198619482;6.20657314096517;9.55111958016074;8.23042042989340;7.25504588554326;7.70783054724707;6.51113791307458;5.00196572414523;5.92705006411384;7.95662622975718;7.33725003068187;8.36334430260292;7.63317028011141;6.53836482935827;6.14629766064483;6.41289916563242;7.49788904233331;6.29735958880852;5.47964142842775;7.66085575500253;6.37108197830749;5.19949340114421;4.67122411441636;6.16708422118547;7.06609663315652;6.31568130156648;6.20949531109294;6.35647257835997;5.17198789329752;6.16443713705416;3.84829191546870;6.21563718775241;6.18551136465550;7.11968429177087;6.33908034298867;7.48850903884199;7.52815095505741;6.97674486566232;6.21270177554429;7.26649365303506;7.81017355722609;7.87696619919349;5.99024507818016;5.33588511477240;5.21316390758978;6.34516587226148;7.23134767592574;6.15221394636495;4.78982243791538;7.57492622894822;6.21489757674646;7.65381769869668;7.44466112205807;5.57379389783318;7.10938497622398;7.31905675419682;6.28231148605906;4.94958724421166;6.74747872517781;5.39833516470554;5.90758855383944;8.01268194676930;5.86018785109403;7.36951214987159;5.70971395391355;5.04325956187850;5.50357704925911;5.30043643808079;7.45084169754301;5.84542720075069;7.33786827900029;3.86972567165097;6.36330842851201;6.07896331016326;7.78207489234177;6.97785575403114;8.46053874134735;6.48698160025011;6.18549518478447;7.24063790824524;8.01278508847442;5.70286923965067;3.59006811059408;6.50995809343038;6.67463265791198;7.94419326035365;6.13451181773100;6.72214172337237;7.23782626341070;5.93822476245372;4.95527628653428;5.77318433382633;4.86322060703118;6.89896456541097;5.77369336026166;5.24168541407675;6.29582482596247;6.84954075542387;6.25077028664431;7.00277927591580;6.94186831224463;7.07800569352938;6.14059059213064;7.36996519635027;5.92505964035190;8.27799863355679;5.73925785217652;4.79728365008681;5.50960833628947;6.37624004885911;5.79100367394467;4.93409052077979;8.76682960608721;6.74913480277982;5.42106649076532;7.89612393956608;4.83703990018659;7.97106081396142;6.50579850006275;5.88965682975384;7.42998459198302;6.06116767599311;6.38286302895698;7.09964376944557;6.67206380725849;5.67621321924165;4.82559601310499;5.19038566014095;7.26636589973418;7.15777977065602;6.15675182448058;7.53630194198355;6.92418982215813;7.32730074647740;7.96362681298524;5.74300314866546;6.32095965891577;6.75420487023551;8.18120881055750;6.82990622782603;6.07591621764360;6.35628279414457;5.18062937119818;6.15541383074750;6.12989743954187;6.88904987615322;5.95843078178391;8.26772341168212;6.40759297513543;5.57005413229136;6.77408875814801;5.84855308557972;6.50590035847113;8.70987634762868;6.85578436149640;6.96737192731553;6.90256754647013;5.88753588574723;7.77916410050253;6.06971548779765;6.76425953930626;5.49773291183685;8.26460707084777;7.49209673829101;5.55357477133765;8.15879707739195;6.13149253563533;6.53815343368902;6.72951391753272;6.91692166208308;8.98569673415744;5.30048757982080;5.24932633474523;8.01297143702253;4.93849384755251;6.69388521375450;8.55391842892389;4.34021466249226;6.54433746161321;6.05699279612202;7.24455909823215;5.29123911167651;6.93527786306063;5.93003404599522;8.03371693136697;6.85840179020599;4.98305852546253;5.45614119289937;6.56011774850219;5.37244563703933;7.79159861410168;8.43904697609796;7.70109936953290;5.40012077242472;6.81683953082764;8.06529516803069;7.47519184815341;7.29211422718515;7.50541695097312;7.73154473396893;6.94486577725517;6.84361053764441;5.84184887159568;6.42896092521215;6.74954244643804;5.52711045411510;5.53474157126746;7.41120976644605;6.28109467500329;6.32820790824097;5.08829954931678;4.96113577228455;7.33270723962959;5.97260299956419;7.32955399087165;8.41057842573540;6.14449264701187;7.26936635635309;9.90924163534219;6.17845845636600;7.14072700459166;6.86184791610969;8.10638904741928;6.05579035927420;6.53677536639467;6.75286346703223;6.75415061272735;5.73154751231131;4.25248447270546;5.43705089136066;5.57088057387889;7.52117187699297;6.95447736252931;6.75348390500990;7.09978822740399;5.83332462259039;7.04117810519969;6.19568789892073;6.68420539011939;6.28941726644362;8.17345847618875;4.94118250558967;8.95222244345610;6.61005388501752;4.94370196790537;5.52613509553741;6.69777302496866;8.24276516563351;5.46438869016937;6.98282760494367;5.85310041968959;7.30307165738785;5.86397511121955;5.35905749593032;9.07887646713233;6.47054163070156;7.52196918758455;7.36915335110053;6.27734668154852;7.87345947043630;6.60827604442990;7.33745563983634;4.89848652909583;4.62477751660688;7.42609744567447;6.14221380286708;5.90748446042856;7.50702777780306;4.41108644561559;5.51091269545692;5.95584366437511;6.94702027089272;6.86366325146263;4.80499131531485;6.09982827966701;5.76473840463568;7.11301774289646;6.06385091896645;5.54737330203536;6.59241254469247;7.19408751062171;7.05159308046082;7.04769089442600;5.36438317113526;5.67677205146428;5.77817054330762;6.91142994573710;6.99395240504449;7.30116804847412;7.16123071130004;7.66140226193815;5.86832076123307;6.13318596039202;9.32320099018588;8.00987632861398;5.78498841610582;4.51541494112492;6.20413310175122;6.01059490292543;4.82631434984945;8.10410547785080;7.80020257284389;6.68998159502305;6.24087442939675;6.88643206937559;7.04773102375281;6.55992099885504;5.63340267038838;6.74368126638264;8.19034610368089;4.63384350950977;7.81857641095060;5.39258158153126;6.16853569523718;7.24948892880209;7.38381951390616;5.61178585109161;6.43029866764694;6.05248786555895;5.43887997105329;7.26056290990544;5.96693994624931;6.32911908419170;8.31198483831631;7.54958083840475;6.34078213862988;6.81096447570345;6.59245208189457;5.09669014099865;7.26146142560892;6.95460282706062;6.97416189891575;7.46697883134539;6.50401423599717;6.28057853491063;5.36815885313142;7.20067598309907;7.69592859342060;6.88364422924204;6.64362009176215;6.37257872957556;5.88000563833055;6.78318325108378;7.47507754185775;7.53979022269967;5.94288808885172;6.91321827525239;6.17905612454111;6.61363151711069;6.81050338430857;6.93873043379945;5.79672242114470;5.73997989078332;6.95857059391784;6.40411463927256;6.87462645623818;7.39942888652468;6.92614076645609;6.54986220536864;7.25445780866206;7.19899779720695;6.07399746744311;6.96123257958097;6.47194367680934;6.87696188964480;5.14345743987869;7.09197054499366;6.17896158067225;8.66412986224104;5.66896840346023;6.67246985770946;7.91629842595050;5.67481697110078;7.12218974594333;7.41842077521376;6.61773360634086;6.02974928094208;7.13909213808445;5.19006396083421;7.12479753363735;6.29381971161107;6.43543487062174;5.57167410585689;6.48193650430402;5.78768724915022;5.86252276340767;4.26785160968368;7.02563548865432;8.31418877978825;6.10912813724428;8.26675468769589;6.38754503004135;6.21180797970603;6.83418034317189;6.71994850940723;7.37379603951161;5.42999419716630;6.46455954772869;6.79229461382490;6.98441287222570;6.74673880138226;5.78830615377361;5.77285706142646;7.23847143127839;5.15012212878437;8.10012709533665;5.86492700917345;7.02442578743226;8.42995475476796;6.11532418923187;5.66521762862953;7.38786268518830;6.94649638975610;6.61332880369765;6.39339068168688;5.60647019699801;7.43254506982043;5.75013887918363;7.35192834983380;5.48512121486584;7.89541553537631;6.66755582698622;4.01574018412603;6.63034916645077;8.49175800829380;6.41156641784950;6.13653004267234;6.26965595025055;8.10868455714673;7.63354492306347;6.95937436440029;6.62941637612873;7.06139825199318;6.08246535121379;7.54295339783168;6.82393906993306;6.86832014945534;7.20233280062746;5.23743865480870;5.45729304071027;5.16008458374973;6.58507261155719;3.91930015309099;6.14441433630526;8.05919236135341;6.63291266288797;8.12616031456761;6.64395329195586;6.65964624259597;4.68009176806590;9.42908089405120;7.20903958106015;7.34334753213435;6.77361997230357;6.83380638107336;5.83327936032764;4.05621258476522;5.71840704565935;6.21753796884099;5.89108424306459;7.15526365902900;6.80764822159970;6.31395659768424;5.42319175550506;7.48684456358751;6.37056088076119;7.33142058141224;7.38060861297516;6.16376730481645;6.65293942670200;6.45116973097906;6.36139261436499;5.26492417426908;6.43692126804450;7.56031987921077;6.54498667423382;7.04447951613376;7.25980351591300;9.72497334678015;6.11834204799448;6.95918064288763;6.10499095079614;5.68814108383180;6.37449163612405;7.13387249103813;5.83565581051097;6.53916378132704;5.67418623365994;6.34419923476835;5.87758484334942;5.51319742983738;5.06697364392190;7.49211099527193;5.88051831452181;6.50588451135588;6.07052512898880;4.09161617840314;6.86803935980331;6.95179209588661;7.24402873996454;4.88040323996572;6.83542191599408;6.95108204660539;6.60522163326007;5.85398223890547;7.74692380820953;5.86737764811411;6.82392282998181;7.24124378939973;4.68874296620235;6.61812654145919;8.02776712431964;5.99184729790909;6.64089864445224;4.96850008698132;6.64007845633539;7.45804139628619;5.57722386127667;5.60814470649293;5.92586691362109;6.57612214642756;7.48926954169445;6.52487836830052;6.83811652997646;6.07540320466900;6.67434387027453;7.12386612163170;5.88596905415164;6.96392990081485;6.85207610056952;7.59450562054979;8.22098729131827;4.38151522403367;7.99430894662179;6.16885317975085;4.76109754550411;5.70514007409110;5.81707911657626;6.18432851498251;5.78164229340799;5.59726831991237;5.55574450505707;4.88105445466267;7.27154022503354;6.10081698889340;7.19328307464345;7.18526580775882;6.21186384002152;5.56815128481667;4.81687439528190;7.39262018264200;6.97825686237369;7.68245177248009;5.93483946560700;4.25596491516735;5.46345654130455;6.41463789331882;6.36271461671911;8.49634334624984;6.77460572472888;5.33578260745811;8.19410972461509;7.50159421145239;5.26677632395220;7.08369998286449;6.82475054629848;6.26236030814222;4.79248861845523;5.44570085147689;6.84444832605296;5.27181487856669;6.13084609534404;7.29032506814638;9.11242526664170;6.93898528095892;6.98238131301676;5.70441357468841;4.49517846631929;5.63837730184478;7.35948490149544;6.52088143960051;6.35299680487439;7.81997932887761;8.23293956397947;6.95849216690484;6.25201302382708;7.07025698249100;7.71175547837400;6.67875319462368;7.57329650313852;7.72413258177710;6.68207178916502;4.96298068767283;4.97664882638554;5.66589437153097;7.52287046717291;5.67626732558327;8.69016610377695;7.18240854668833;6.88954228028160;6.21555229369427;7.57717725475855;7.94535908875524;7.19869237053945;6.14561784534054;5.63574500820144;5.96283383571149;7.15295691243818;7.49414407014560;8.00468111527144;8.08782647319447;5.33285937565144;7.94025042120422;6.78249503822897;5.60274200485301;6.63424475049001;6.26357182836454;6.68611851073692;6.31390388660077;6.11955060157915;6.32810763944065;8.02629204098973;7.57310022784560;7.17449785889288;6.99943601867320;7.76178048833949;6.04265167797702;6.28949621272484;6.36834461861602;7.95051576811151;7.06096546812017;6.23606511712877;6.08898568488660;6.26650964243249;4.83683872541343;7.51308884474697;6.79351504214591;5.80679820970601;4.48064332059503;7.56507687282668;6.80594653645072;7.29070760420310;6.63066730758650;6.60135691739742;7.79043297827440;6.91511788248693;5.20292549516442];

%For x &w unifrnd specification (all between 0:1), J =6 , M=20, T=10 and I=100; sigmaa = [0.4,0.3]
% p_jmt = [6.21820541810332;7.38866744410073;6.48520676507313;6.10409599202764;6.82833935992061;5.81844542986867;7.36204095475062;6.04764823188437;5.56866493508766;7.44283303889206;6.71012741391344;5.13747915746554;5.74257260206465;5.17282728343599;7.01834512432030;5.63068195797187;6.60890722539715;8.01315514834123;7.85974593107474;7.34326150343761;4.79056917352385;7.42351327203635;7.77374905516265;6.71177590661765;9.02359382127696;6.00071335746520;9.16615968627134;5.17216015213442;6.13321274588640;4.63126575179540;7.04177420514212;6.72325783413559;6.09469802204648;4.92951397357134;3.68143948110661;5.27657680865134;4.75342539351159;7.37953538536610;7.35662328054209;4.38245284966626;4.80426750268029;7.03557770654645;7.25253385516737;7.33899541735438;7.91935350081152;5.66786535044646;6.23566953247947;4.78555360673536;7.71142643794150;7.60034083817497;5.53652099774186;6.65923463425656;5.68497758234936;6.95000463776638;7.51933995598186;7.86961316976445;6.80931503045583;6.56002515055848;5.79097680095908;5.89816170182063;7.44501332531102;6.08526645128604;4.60133992881924;5.46703186289764;8.00550094371282;6.75911400249084;5.76672723535534;7.02692368644121;6.93592256539561;7.41008412846774;6.40716128277818;8.88178039476608;7.99050555334876;4.12131308690563;5.08909919346223;6.89734113346699;6.96052166058491;6.01176098201326;5.64899289903022;6.09471739782636;5.14582704194875;8.62981466629434;6.24894119696262;8.36890077154558;6.42815427234674;7.03850405947681;5.34860272618302;5.55442210681800;7.44592061280527;7.07323738319627;5.47831786008151;7.18529871685345;5.87556247864214;7.87180923619733;4.99364512480570;7.82087003913136;5.02221323781015;6.76520564880583;4.57192032076093;6.23455279042572;5.58080492351165;7.68608813724025;6.14753741378208;6.87042436664876;5.58836042783487;5.82294160645229;7.24306724304989;6.60978415462606;6.82497048562671;7.76610746713871;5.19271257092130;5.90725473221594;7.10848155634377;6.78167019928433;6.19235740743063;5.89445501133949;5.49399432355216;6.26069332848707;8.09071747505853;6.29539136161487;7.37742042745957;7.66587129505345;8.24581585203663;8.31653327847374;6.64344913495257;5.22632655249919;6.19907211571445;5.85943836183799;4.59345159120912;6.31156943921619;8.21865852697058;6.02013547835873;6.51606759899888;6.51307848979452;8.64195473795569;6.18744103139415;6.31289165807948;5.30196193000479;5.97965827682212;7.39759422103594;6.94694356470743;7.21321386344600;6.72407068563270;5.69884261000710;7.09467891722950;5.69878098126553;7.43918391035058;6.79581411889629;8.26232826917552;5.21532913782990;6.36000306129519;6.19490278595781;7.10444571776124;7.00671724617614;5.35190149292215;6.60885046949356;7.99335650211772;8.42234705403910;6.47036943617011;7.79402126553178;6.02792571400771;5.94444865694828;6.44393251341696;4.88593741215359;5.81354557604477;5.40693793381257;8.61537919895744;6.86713208937398;8.55684448837907;6.47974489453992;6.77988878199629;6.58580178943166;5.73674803908656;6.61310724109583;6.10066911087156;5.11915215289802;7.53794443855163;6.27861491624723;6.16531861664816;5.81041147513802;7.01032025528509;5.80925962863681;6.90300112049400;7.31305267986877;6.73806080820010;5.95151952901468;6.02197825221668;7.80070483521561;4.98419094934114;6.98959972191438;7.12344900367709;7.29489581254781;6.61936364759809;6.90926661910701;5.32696619553189;6.73325685819378;7.48220887600490;6.76813630729118;5.90274866846431;5.92705462177342;6.66360192372373;6.44627140762463;8.24736024436364;6.71848438594359;5.93696476476428;8.04979100235255;7.74771043975962;7.08816817268160;8.19150523115595;6.28079350513689;6.26049921642998;7.30703402174357;5.46103088201222;6.94250549830912;5.29306985237367;7.11533252936582;9.08254144817361;6.25690239482084;5.91152370975264;8.16247000472054;5.67059149684612;5.92103148202398;6.55386836325833;7.20533575731250;5.14275841945097;6.03560034875978;6.62321688602857;6.32098354471808;5.15099142144918;4.00761655621852;4.66281720881853;6.77528808202909;6.71142318374481;7.30889746161732;5.61754000876251;3.83483923346160;6.98866495194121;6.77125592906921;6.33394305403017;6.12914293090526;6.29911040021406;8.84811118212284;6.18443759998244;7.19324642393691;4.39710667162969;5.23669403250592;5.68900124127879;6.53248658939237;7.32777660370868;8.82030589464003;4.86468875990262;4.65533367401431;5.83080435820929;5.58897538532099;5.09058520035915;7.62111991948096;5.94020515213330;6.41712002313439;6.60883586002501;5.05980284650999;6.70341032552889;6.95073161268126;5.25109525130941;6.22469799410622;6.54650494865074;7.86990785950103;6.07063852169093;5.52111998270742;7.33936844477650;6.05983665260863;8.75077383134489;6.83194670073257;7.55216234116158;5.94275327552138;5.82785468196016;6.14221876430482;5.81683770016656;5.80068251013623;7.68356626894915;5.98283884998945;6.31108092931281;8.47106361670069;6.21937514191407;6.52516744997433;7.42624156049561;6.60851895164673;6.52502899845708;6.28017848495243;6.54253021470117;8.21269963497136;8.44447580866724;6.97585241634044;6.19328672388296;6.57124068001074;6.27049708545560;6.63319570545661;4.62943957320624;5.35392084058462;6.20002416947070;5.89468434134939;7.29687610586141;5.21089466801208;5.93858949493095;7.17793390646489;7.16151756694950;6.28071103247566;6.36681381061136;4.59135250063450;6.14208228268578;7.00673738578140;5.97037243427094;6.04673724216287;7.35139796501089;7.70953785094843;6.28438047699364;6.85228623094276;6.64145023334188;6.24545193420779;7.46330928434679;6.28909727424140;8.15708897233679;6.24956016923470;6.48956395797599;5.74148397926910;5.53674000462642;5.25718750747075;8.23506353243202;5.92218444003282;6.28470002728964;6.33005907508786;6.41270000866652;6.02918366689669;7.80487045927647;6.97477494048340;7.05598358020409;7.59324980175201;7.85975334800444;6.41002222796123;5.87379940046116;6.60143458364937;6.19154679972559;7.87846865991254;5.17467182933030;7.27004374352181;7.89825595831060;5.50447838385552;8.34629430612923;6.97273288070286;6.34283934083862;6.61367959559989;6.54521770869176;7.18674539869679;5.97193035508880;6.20631067322192;9.55108836533562;8.22963843139995;7.21898165254454;7.68232288736096;6.50915547033394;5.00215252619548;5.96984870404973;7.98836772803610;7.33739664142763;8.36334416142710;7.63316675410006;6.53792666858987;6.07616281287050;6.41271639238752;7.49783571681809;6.29731463147151;5.45781338022227;7.64627359500569;6.36264014016608;5.19182373384457;4.67156463883157;6.18619909418122;7.14835445115773;6.32437857360252;6.21095005787203;6.35642937405488;5.17152766335191;6.11438853947306;3.85552910446313;6.21412276051719;6.18543091826717;7.11116904369206;6.28207249312208;7.48772390506510;7.52812169832955;6.97666400568626;6.21103619826323;7.20850231027447;7.81006579925142;7.87668430562748;5.99021914129403;5.32048661360252;5.18846883767780;6.34430694694951;7.23082287204078;6.15207340841520;4.78875851787797;7.54352192907405;6.21359698818969;7.65257191099084;7.44452277166854;5.54336185938497;7.08944564063973;7.31848150347759;6.28219259660138;4.94949725082718;6.74568540093609;5.38351841455144;5.90731531632295;8.01230878226345;5.86011641917749;7.36673193598131;5.70286619041572;5.04099336503804;5.50149947977870;5.29946384358039;7.44995981091009;5.81645022933041;7.33748124442928;3.86589331077459;6.36329749950138;6.07833760762103;7.77130201542843;6.97746320317878;8.46043685990765;6.48687401246150;6.17551656138625;7.20452387242444;8.00952705439675;5.70173314304279;3.59006139712668;6.50989327460676;6.67256494503218;7.94417254056229;6.13450714253473;6.72213962047694;7.23772793364790;5.90393036185565;4.95714372544117;5.77306620799293;4.86305485118934;6.89867664495142;5.77244549666645;5.24074280734701;6.29569283918097;6.84923596028049;6.25010510394184;6.98294012538630;6.94055064564755;7.07771702678084;6.14057302783631;7.36985564795384;5.89958175339681;8.27791860772258;5.73911046329004;4.79726879010565;5.50800705904470;6.30495061999456;5.79082226740106;4.93397248018976;8.76682948965545;6.74905860423557;5.41235980957035;7.89612214091283;4.83661250294252;7.97106074817077;6.50429218383404;5.87001828613266;7.42995715226214;6.06114370347947;6.38217062809582;7.08619017860725;6.65486314756337;5.67091128279275;4.81021625654949;5.19029746887240;7.26597459547371;7.14571135071147;6.15654163340716;7.53612698170658;6.92411140460973;7.32701480804466;7.96206997163692;5.74254916458270;6.32080812476560;6.75418834729699;8.18007367529081;6.78908153976972;6.07286649762806;6.35591993187323;5.18061051034755;6.15520983673870;6.11196292197925;6.88898248213519;5.95813683225301;8.26772174811535;6.40723691934495;5.51086703753984;6.77298972281448;5.84846771705711;6.50589817604492;8.70969927822641;6.80595535583979;6.96687604106260;6.90226525544035;5.88747778731673;7.77423294170078;6.01876554576805;6.76353560310414;5.49683561425780;8.26447866729063;7.49150242613352;5.51378894574943;8.15869787477315;6.13124507573781;6.53811717247238;6.72193297520565;6.90778404145148;8.98526776399251;5.26067056494041;5.24931997144317;8.01268811883087;4.90155098324205;6.69385017098501;8.55391487649146;4.34057892693458;6.54431514550236;6.03501991242093;7.24446451096177;5.29305005532461;6.93526126771909;5.92953331411434;8.01853173404003;6.85752588226822;4.98189595848332;5.45617498810733;6.56044581967464;5.53517004780547;7.79156583630190;8.43897860699469;7.70106573869637;5.38747933025008;6.79812210185533;8.06336499201154;7.47509879297735;7.29205548118745;7.50248419192040;7.71387065282758;6.91961895638975;6.84303162259283;5.84181930472553;6.42372181699670;6.71543628426409;5.52366796874817;5.53448212277666;7.41115974897994;6.27250491656920;6.28042230557988;5.08788419235805;4.96018262592464;7.33269798602135;5.96892272328127;7.31516395230690;8.41057317279182;6.14443369302291;7.26935853110101;9.90919689570783;6.14800051833099;7.13968109851619;6.86179328897243;8.10634137612907;6.05637312222416;6.52535798725471;6.75108834318368;6.74511303638035;5.73152989076903;4.24822046668934;5.38445665417329;5.57060642141804;7.52115829307109;6.95432416700728;6.74996509672778;7.07482970887391;5.82561021127795;7.04112798649592;6.19565524563000;6.68376075892486;6.23686403180811;8.17333178922855;4.93293627202868;8.95221979283286;6.60883919777579;4.89449098883463;5.52604474915406;6.69776324745697;8.24276197812146;5.45496627620472;6.93049377413334;5.85169566707533;7.30271745383654;5.86388653646040;5.34796113423640;9.03717632964463;6.47045340391937;7.51771271036841;7.36910001294202;6.26609375929241;7.86298999200534;6.60590401251029;7.33621042692241;4.89833303696521;4.60738688264888;7.41376194842136;6.14091370354178;5.90697238636603;7.50700507883332;4.39138283586377;5.49302048454179;5.95533344390022;6.94683504521330;6.86358100726660;4.79837946432135;6.08529397441531;5.74749903260756;7.11144925087494;6.06384592828282;5.54774486126042;6.54326261300579;7.19404043907713;7.05154688667779;7.04768972242471;5.36281084840610;5.66992557293550;5.77456949274269;6.91141865727457;6.99392001027455;7.27262080777905;7.14614221057707;7.64796793359129;5.86554109240071;6.13316398410003;9.32301959076383;8.00544855823625;5.78489419337720;4.51310361426969;6.20408299940100;6.00900177706965;4.77225611031156;8.10369324264273;7.80018941661792;6.68991959045261;6.23629190218081;6.85838055886905;7.04716825169401;6.55942825413759;5.63330776724289;6.74311673955701;8.18051252056865;4.60066735791259;7.81852324624046;5.39255822132648;6.16822507884789;7.24346362551358;7.38362219149342;5.61177141335228;6.43022532725283;6.05227216631151;5.43372942285878;7.26038300040722;5.96651793903370;6.32899502828021;8.31088838954441;7.50626557064394;6.32636085811904;6.80707538206095;6.59242317284406;5.09367430966422;7.25308502135856;6.95342493910915;6.97389694558262;7.46697243906979;6.50066069788239;6.23429977316462;5.36802559022209;7.20061603485025;7.69592853280748;6.88362643389678;6.58282061478539;6.37256507698897;5.88000290672788;6.78313788166832;7.47235742114921;7.53538765400512;5.94275935824555;6.91280360613414;6.17889388180458;6.58396993735474;6.78370101722636;6.93664938088254;5.79487555669803;5.73997487033068;6.94409411479953;6.39243247413515;6.85638572697872;7.39925396122687;6.92591227957177;6.54876950400882;7.18996485103917;7.19723209330454;6.07353347742427;6.96122909129436;6.47104835686603;6.81255315777943;5.14042381565929;7.09195441001806;6.17884206152304;8.66161948615568;5.61550797245495;6.66787298569904;7.91411732771332;5.67475695232054;7.11896464342216;7.36687454769997;6.61418687370789;6.02801401984912;7.13908826409280;5.19531956445178;7.09176320083931;6.29397191796109;6.43553209107138;5.57166496903248;6.48039958373058;5.77218300474256;5.86133386540934;4.26573611623141;7.02541229025920;8.31388678045802;6.10174184959080;8.26651606985458;6.38743832478952;6.21180360934171;6.81578236405941;6.68258654877733;7.37376467921732;5.42890003371585;6.46455436597389;6.79156766628546;6.91128754391708;6.74663743170698;5.78785571067353;5.77262958730410;7.23611046381028;5.10700862264117;8.09998186239737;5.86273972742327;7.02420537141556;8.42932841636181;6.09971116041232;5.63364478351363;7.38687302243553;6.94643282443102;6.61328480857497;6.35548220100044;5.60509109118322;7.43249177170694;5.75008658861177;7.35188176539072;5.42169804236293;7.89535365230029;6.66719861874953;4.06692459658678;6.63560424258800;8.45071510595004;6.41772259036083;6.13672653554459;6.26954831461793;8.10762405142437;7.61178256501637;6.95872511982134;6.62387283458189;7.06139658784555;6.08150443902265;7.47819768359026;6.82367090670678;6.86819131825787;7.20230372499459;5.23723621747245;5.44654237357086;5.16026585086962;6.58472801452260;3.91881198980905;6.14008201724640;8.05187527347144;6.61501346211754;8.12608907717456;6.64394446130122;6.65954448685207;4.62176524637117;9.42907684166560;7.20901594004645;7.34331016068131;6.77049743718984;6.80682140385373;5.82926666828269;4.04057129374347;5.71830844767103;6.21720398259910;5.86622766732601;7.15277978348778;6.80683200761389;6.31390893185128;5.41294612491114;7.48524580115597;6.37044567024095;7.33105644551470;7.38056136776400;6.15454023104346;6.61794962546924;6.45084486608187;6.35737552531785;5.26489741267104;6.42898115263853;7.54854991291852;6.54486203865891;7.04424958235145;7.25976574387402;9.72495045382935;6.04590595427007;6.95909051933653;6.10465492700451;5.68813473462656;6.37416657214940;7.13135802177290;5.83554713585004;6.53915623790526;5.67418451663527;6.33545287896199;5.85618919102976;5.51160606297872;5.06754536479524;7.49210890726956;5.88032014179319;6.47464671286928;6.07033054782693;4.08935112068769;6.86799701344198;6.94130338130821;7.22610367719214;4.87790618632252;6.83454308878116;6.95105182957030;6.60174392359074;5.84693343697097;7.74683936487993;5.86384422494786;6.82389642924349;7.24078317479880;4.63950469572986;6.61807841281847;8.02775471577465;5.99184710113240;6.64065045096345;4.96178339917004;6.64005704737048;7.45801963227603;5.57720932787776;5.60788214580695;5.92394574145813;6.57589819175683;7.48922052729350;6.52487704949858;6.83810088130745;6.10507025828684;6.67433794592134;7.12386424571333;5.88596081259184;6.96335615793912;6.85034787445693;7.59441125710417;8.22094939774917;4.38143435618515;7.99421641779559;6.15838136260459;4.75547719694975;5.70451079416853;5.81703932734210;6.18176656261542;5.76387042518065;5.59566183347174;5.55300138858307;4.88068161539027;7.27000029693616;6.09188017178628;7.19262633076586;7.18472381381428;6.21141371146186;5.56780060801108;4.78830333061297;7.39251323364491;6.97820566849859;7.68245136736422;5.93462862880920;4.33039154578612;5.46341420776083;6.41461727356235;6.36270507572225;8.49557161654769;6.77365098639757;5.33392100216111;8.19392936353649;7.50158992382447;5.26391746893382;7.08124130915372;6.82411775887002;6.26208469102058;4.79118256358153;5.43639333108592;6.81915240333482;5.26824749099736;6.13067035015333;7.29032417115196;9.11234332343489;6.91857539724382;6.98194450700252;5.70408998632099;4.49326824625060;5.62794651088586;7.34616169465053;6.51874862736428;6.35075384395711;7.81997492886758;8.23248374092201;6.95624670670321;6.25198171073074;7.07024829782218;7.71173971296066;6.66988974258203;7.52477439096460;7.72378205686597;6.67918269035341;4.96297480587813;4.97459272612007;5.65576125005086;7.52212320456110;5.67616298939938;8.69016463195352;7.18211745834543;6.85641794592228;6.21533185632066;7.57692897387881;7.94535878585912;7.19814404283528;6.13176582610332;5.63519157745843;5.96252345283243;7.15190229410226;7.48687778372142;7.99502127274632;8.08772063964775;5.32132049161240;7.94025017158114;6.78239207910497;5.60038106403713;6.63421931108425;6.26355324005580;6.68611759239202;6.31334425305017;6.11208743551159;6.32802741973360;8.02628840206798;7.57302434776682;7.17161463232402;6.93010295471285;7.76104809792200;6.04245144854312;6.28949291959948;6.36818964520987;7.95004378015463;7.06061393586851;6.23593487114796;6.08895431368726;6.25576794232758;4.83117866608569;7.51307180181274;6.79348636582835;5.80678266675271;4.43943707998670;7.55932375783782;6.80494276193954;7.29065373993610;6.63065869576582;6.59792838860809;7.78774441285169;6.91507672702277;5.19824433097656];

%For x &w unifrnd specification (all between 0:1), J =6 , M=20, T=10 and I=100; sigmaa = [0.2,0.2]
% p_jmt = [6.21115640471672;7.38511399877830;6.48146345200147;6.10341157316832;6.82831857572843;5.81235083790688;7.35002746926050;6.04606565744556;5.56039534652943;7.44283301680406;6.71011950982110;5.17183925164913;5.74258695411236;5.17285164049746;7.01832502832994;5.62864163493158;6.59782907415226;8.01311026764982;7.85950135139299;7.34325726769644;4.78547172701959;7.39456989314851;7.77304987414678;6.71084661567615;9.02359273894978;5.99334812896989;9.16556100101256;5.17101305097446;6.13317411594740;4.63123607775324;7.04140763290377;6.69659147097383;6.09447741639863;4.92700206845204;3.68143292290023;5.27648673453974;4.72647094535293;7.37952994814005;7.35662235730189;4.38310603950725;4.80806361850671;7.10460803674038;7.25258154933305;7.33901420899859;7.91934703610882;5.66559985565405;6.21557365831461;4.78368687583359;7.71136790498247;7.60032048906873;5.53125935513394;6.62756457501080;5.68475071096524;6.94995430457379;7.51933445962534;7.86799453943625;6.80070176272006;6.55966768484384;5.78878935650083;5.89813331296175;7.44484772344923;6.05651705481541;4.60149540750165;5.46616625678811;8.00550062712662;6.75910037352063;5.75498943485907;7.02691916390880;6.93589560397262;7.41007581204418;6.40707077095634;8.88113362497009;7.99048799155788;4.11906014227635;5.09071172284023;6.89464792741655;6.95245509072214;6.01249186242817;5.64933617638435;6.09470441386346;5.13852717017801;8.62776747222387;6.24881025013209;8.36872154388784;6.42815364370247;7.03835188604500;5.31699745117118;5.55418669094255;7.44591613095945;7.07323640554780;5.47747833910433;7.15566090292051;5.87219663278159;7.87163792215873;4.99362964271755;7.82066984790510;4.99667241765407;6.76518178747377;4.57185084037485;6.23451758911003;5.55504665648735;7.68113129393802;6.14496982821128;6.87015460142578;5.58857530072162;5.83306244270087;7.26496168065131;6.61000119222770;6.82850373834149;7.76610487154021;5.19290147241123;5.89340172656597;7.10817543676188;6.78166361744720;6.19234504659643;5.89338451616666;5.49579141292775;6.26068674962832;8.09069322913715;6.29530229530125;7.37144953739680;7.63241891946635;8.24472520332547;8.31609675663068;6.64343265045735;5.22616132175775;6.17744820702579;5.85937098447257;4.59517047846090;6.31161223392141;8.21836725796795;6.04485979707994;6.51607664709843;6.51313163864643;8.64195468773085;6.17955511797466;6.30102690766515;5.30125904965808;5.97964359382395;7.39773284094181;6.95065272263979;7.29296047878750;6.72568452806327;5.69975909109630;7.09464145200968;5.69398399467994;7.42711651717708;6.79563471850531;8.26224940251920;5.21551507195152;6.36043438650730;6.24394242014942;7.10450701795938;7.00672972838146;5.35155183952008;6.60782286457366;7.96119995871118;8.42232658828399;6.47032900645943;7.79401424930840;6.02894461084034;5.95838681905289;6.44398189842837;4.89430668619634;5.81349867137787;5.38771450828290;8.61255701252243;6.86704009837061;8.55684291225110;6.47974434505627;6.77962908824130;6.54386223445860;5.73672297108391;6.61309300196763;6.10068586473502;5.17324370199482;7.53754047791406;6.28053810050979;6.16700879011783;5.81029076175708;7.00912416909671;5.79038017506281;6.90295299672910;7.31279811744054;6.73805163969365;5.94582994093289;5.99405431127349;7.80058026447450;4.98386879760603;6.98937848125934;7.11978368615817;7.25593908702405;6.61902685153777;6.90874407334324;5.32683318192802;6.73291700177392;7.47006045332259;6.75840775955078;5.90148425797650;5.92705223466998;6.66354887216631;6.41452529507902;8.24735385849673;6.71844473990867;5.93690552848816;8.04959150219923;7.70034878802776;7.08705418087685;8.19138990740203;6.28076249437634;6.25862453487133;7.29904410275670;5.46044440270703;6.94184712581710;5.29305522910322;7.11522600508256;9.08235243706673;6.25655724352871;5.90916972414790;8.16246921556830;5.66702769069408;5.90920211605630;6.55372589197579;7.20513517291362;5.14202797526212;6.03341509594288;6.61556804649708;6.32090289250403;5.14949263712506;4.01182927324064;4.66765583902456;6.75472280361052;6.71082458070026;7.30882774210476;5.61753887368486;3.82079880485423;6.98812459294730;6.77122894951399;6.33393639029376;6.12904475125337;6.29583337082375;8.82534568816964;6.18322454255746;7.18440528267582;4.39701843165781;5.23597310238804;5.65503781086469;6.53236502093836;7.32772668669908;8.82030487018590;4.86434682461431;4.65929437987721;5.83070345923578;5.58893233246461;5.09031539510165;7.61953688318554;5.93126629426507;6.41681136757097;6.60855631629536;5.05982940955789;6.70060041537137;6.93239889465229;5.25177452570500;6.22469565400045;6.54650407782511;7.86989551251607;6.06714686829390;5.52111138316102;7.33933802393479;6.05983487698625;8.75069576036195;6.82855618753429;7.55215709032622;5.94240526575629;5.82811770510763;6.15470169639830;5.83867088865050;5.80336868032920;7.68355139878740;5.98283136865870;6.30124235091153;8.47095018160682;6.21771071326038;6.52484369477773;7.42624050254496;6.60823405883370;6.50754639047642;6.27937022247232;6.54224401796038;8.21269627211800;8.44427445652222;6.95378678036859;6.19311789439071;6.57098016678626;6.27049665504574;6.63244623407806;4.60049315555063;5.35379689028093;6.20001579700088;5.89468920155748;7.29610173558566;5.26991564827569;5.93975018043135;7.17791545761832;7.16151687750344;6.28318873688332;6.37073086783703;4.61033534227650;6.14209308423409;7.00673568988750;5.97034695229511;6.04223545521585;7.35124754944294;7.70947038300812;6.28436776049749;6.85154127491740;6.61357603248842;6.24536565268738;7.46327722544652;6.28922469548314;8.15692672875013;6.28966071804978;6.49205511989107;5.74286560044220;5.53664508068005;5.24628103576644;8.23387405946247;5.92049838931079;6.28394527808963;6.33010398383884;6.47166945420092;6.03425130143903;7.80495620969917;6.97516877111048;7.05598096390800;7.59240723890513;7.85729138162229;6.40953562792293;5.87262869780276;6.60218457906657;6.21233476542047;7.87595225836515;5.19883214009379;7.27003034031360;7.89825156118241;5.49628151332741;8.33557870730999;6.97236188198687;6.33720587120934;6.61367511751120;6.54037680779320;7.16360476173451;5.97146039298019;6.20551058861221;9.55108046263919;8.22932582873070;7.19950259155151;7.67039853814545;6.50776645885461;5.00227597653719;5.99688966931381;8.01187284048440;7.33749545817676;8.36334585407134;7.63316571034620;6.53774104382188;6.04313437757267;6.41263579401272;7.49781919578321;6.29729622965635;5.44640163833662;7.64253100886780;6.35928957525496;5.18740294049133;4.67162605516458;6.19315406358188;7.17426377467920;6.32760657101344;6.21148688553093;6.35640695853263;5.17099143883132;6.08685646211804;3.85765730135669;6.21329437291201;6.18537778771042;7.10718997771435;6.24694900985220;7.48739788458020;7.52810970269346;6.97660586786146;6.20851489958708;7.17245163169005;7.81001139251830;7.87654540700548;5.99020662292434;5.31082640548999;5.17194787543067;6.34394210012262;7.23065782868214;6.15204263837395;4.78841555461335;7.53927152007712;6.21331790485874;7.65240475261872;7.44449091089278;5.53081717508634;7.08436964378594;7.31834326272602;6.28215241387276;4.94948338480187;6.74553916644603;5.38156972450288;5.90728491934623;8.01229030495811;5.86010904538639;7.36657044555886;5.70212381106181;5.04068378560383;5.50125659281987;5.29922785697406;7.44985668469571;5.81063588913136;7.33743405526741;3.86451027200860;6.36329657444316;6.07827893201245;7.77077598830610;6.97743680058820;8.46043305431852;6.48683642728132;6.17172838385759;7.19479210590801;8.00883434965630;5.70123324154828;3.59006042347894;6.50988995443491;6.67246603532068;7.94417196014827;6.13450686416334;6.72213867734899;7.23769072771129;5.88267886831914;4.95741369152263;5.77297948421340;4.86303867419757;6.89866386287486;5.77235860291431;5.24066259014318;6.29568534697453;6.84920392850800;6.25001904196001;6.98099051601010;6.94041674674566;7.07768907394703;6.14057059828806;7.36984592266268;5.89585021427796;8.27791360463724;5.73908712022389;4.79725307896370;5.50684071200287;6.26722013432308;5.79070347562620;4.93385848281938;8.76682948666257;6.74905403598917;5.41149995565678;7.89612207363799;4.83656047343123;7.97106074423225;6.50413481897149;5.86749685114233;7.42995512208138;6.06114076624239;6.38185156513251;7.08137733566998;6.64776631371458;5.66780895279154;4.79777870381286;5.19028598547176;7.26595055444441;7.14494373949770;6.15652204175952;7.53611730999186;6.92410794232273;7.32700413915656;7.96202574513684;5.74251707395101;6.32079957753162;6.75418438677733;8.17990579440074;6.77975991932849;6.07196562681420;6.35582134799372;5.18060764140059;6.15518757256561;6.11001015420493;6.88897685938395;5.95810244156749;8.26772135692058;6.40708116012698;5.47602621731034;6.77256397101632;5.84842233322986;6.50589623055660;8.70964020794060;6.77259064377406;6.96656020213682;6.90206579355169;5.88745348276544;7.77312409474204;5.99912122903522;6.76330588334167;5.49641393117822;8.26446605133120;7.49142450377156;5.50393959673648;8.15868772657090;6.13119296204848;6.53810382744744;6.71933080822550;6.90484166066238;8.98520129423764;5.23916638179863;5.24931656799907;8.01262824832157;4.87882325371824;6.69383874258204;8.55391425616087;4.34076350998486;6.54430393006906;6.02048320687674;7.24442729689761;5.29357285326803;6.93525979703064;5.92947038910723;8.01764670146160;6.85744612900470;4.98169853495486;5.45619798074019;6.56078362358624;5.61539418864670;7.79156015103099;8.43896504147073;7.70106193211409;5.38442189243587;6.79526316758875;8.06317409466176;7.47508736712079;7.29204104288667;7.50181319038893;7.71015476823733;6.91280282177350;6.84286761674015;5.84181049185783;6.42242450151757;6.70794797963473;5.52254499907169;5.53439745413024;7.41113969500522;6.26738823048877;6.25267473789257;5.08735588815824;4.95871758990444;7.33269729326460;5.96847465452087;7.31409522276268;8.41057291381024;6.14442690980325;7.26935762239095;9.90919502918509;6.14293673474824;7.13955399810288;6.86178595722900;8.10632341354206;6.05528523625485;6.51616317847743;6.74990114138042;6.73914678650011;5.73152322889385;4.24566885487820;5.36315715196635;5.57049738118988;7.52115548605406;6.95429779462708;6.74931909726378;7.07080253422741;5.82372031539821;7.04111960555952;6.19564031403955;6.68358740916200;6.21410331902811;8.17330207326957;4.92728492302221;8.95221956083797;6.60858395173265;4.87718892050763;5.52601752568819;6.69776125275578;8.24276095336357;5.44686468666973;6.90525842689427;5.85066286746657;7.30256078812416;5.86378783707550;5.33095597813129;9.02333229855653;6.47037880673337;7.51526860483033;7.36909464010333;6.26445264380762;7.86211847218144;6.60559263964046;7.33608366383080;4.89829411450881;4.60267498619912;7.41242599798946;6.14069099335746;5.90687752582987;7.50699972489746;4.37557777721066;5.48478842112328;5.95512946996112;6.94678203896562;6.86356584395576;4.79605637082167;6.08186832277548;5.74298515509948;7.11118440152978;6.06384080900869;5.54738605134776;6.51210505351928;7.19401713685281;7.05152274436459;7.04768965182270;5.36263294123457;5.66923453970336;5.77421834228148;6.91141793953660;6.99390253893963;7.25894194901242;7.13852397453714;7.64219923941262;5.86339113546874;6.13316238087384;9.32301607349618;8.00529736072281;5.78488636012681;4.51280528627223;6.20406917637346;6.00853373525364;4.74965915381715;8.10363551176749;7.80018735086057;6.68990923982002;6.23540905661161;6.85407244833786;7.04708500911825;6.55934240954675;5.63326093084252;6.74292641418983;8.17851103447781;4.57468971697758;7.81851081709413;5.39255600263099;6.16820294548063;7.24318463453671;7.38361351111371;5.61177014649087;6.43022086813497;6.05225696312880;5.43327350403466;7.26037519552465;5.96648720315901;6.32889359941686;8.31044972112654;7.48421031591439;6.31477477928163;6.80445741701522;6.59242091646480;5.09327546785144;7.25258213933952;6.95334490096955;6.97387906609451;7.46697117475802;6.49974926257351;6.22111124783318;5.36797427844090;7.20060305005294;7.69592850711521;6.88361633021895;6.54464654766366;6.37255512523671;5.87999964623028;6.78313517834325;7.47223475110542;7.53519449325747;5.94274878942957;6.91278013745032;6.17879490909130;6.56859258905393;6.77066750252547;6.93566363802057;5.79359562328583;5.73996027754292;6.93488009375636;6.38217760395753;6.84432436790640;7.39916037151080;6.92580430475241;6.54819102481945;7.16316414256276;7.19646644901486;6.07325036303160;6.96122727759557;6.47049616255241;6.77857993973441;5.13670916905317;7.09194638535746;6.17878835498645;8.66113772822257;5.58772883259614;6.66612028371925;7.91357024392088;5.67472057731729;7.11769644212840;7.34886642446677;6.61255908601711;6.02706527557216;7.13908573180010;5.19795441104100;7.07070797217967;6.29398596825428;6.43550277373811;5.57166369071380;6.48024374019020;5.77018878611098;5.86118344149113;4.26529183214505;7.02531198826275;8.31379658491979;6.09320149568180;8.26644373639391;6.38737079750030;6.21180158402685;6.80885737642371;6.66813523780679;7.37375463899983;5.42825991181536;6.46455057920279;6.79110592414516;6.86801158399721;6.74657181362116;5.78734434155085;5.77256486955453;7.23570240197606;5.09248582480155;8.09996354700371;5.86213647582623;7.02411408964752;8.42916899738230;6.09078932914071;5.61141876885761;7.38651164743320;6.94642193759733;6.61327638209064;6.34785402246646;5.60472814202977;7.43248405572787;5.75006502451811;7.35187043549455;5.39389359231791;7.89534123208748;6.66708905153071;4.09796254485079;6.63747348059069;8.43204477625163;6.42030632589991;6.13682047465608;6.26952970545598;8.10752630264078;7.60943649504449;6.95863564016412;6.62302307766798;7.06139585118201;6.08093823980877;7.45421321558829;6.82354342390197;6.86813087292770;7.20229419286889;5.23618076575575;5.43898507896783;5.16015503283305;6.58459196531893;3.91864691111126;6.13930271665670;8.05119722055044;6.61229399241571;8.12608260540914;6.64394198944277;6.65951615433835;4.59095168591174;9.42907643325532;7.20901047724070;7.34330066064460;6.76953498062193;6.79879652738559;5.82757957935257;4.02853409881526;5.71829089397904;6.21715360551160;5.86211135362614;7.15251092705337;6.80673176535474;6.31390506795221;5.41180513298096;7.48516410975102;6.37043652940049;7.33103661598206;7.38055077709542;6.15149748349066;6.60819661253644;6.45074622309113;6.35612460310012;5.26489294864878;6.42808696722069;7.54766938522511;6.54484845134359;7.04422861463785;7.25975131687077;9.72494675431514;6.00561416036502;6.95905254897941;6.10446664897617;5.68813426890701;6.37414833166452;7.13125469210197;5.83553960202679;6.53915584160834;5.67418300859928;6.33066420804996;5.84107874580060;5.50980833492483;5.06707033983639;7.49210865980824;5.88027954818773;6.46952882069198;6.07029304121280;4.08857968343005;6.86799052785255;6.93975285434573;7.22371674060279;4.87720244499945;6.83440708994835;6.95104972626929;6.60146820423867;5.84619836895097;7.74683507741278;5.86347664670375;6.82388905995620;7.24067136173641;4.61143498988439;6.61806404384461;8.02775242583720;5.99184708663350;6.64063628688627;4.96106577021648;6.64005582500175;7.45801874462382;5.57720824577006;5.60786282801139;5.92382081834177;6.57588694382536;7.48921884536496;6.52487664869754;6.83809483676155;6.11839724690088;6.67433570625795;7.12386354176633;5.88596026438953;6.96333142215607;6.85026989678447;7.59440813668092;8.22094844213246;4.38141956499272;7.99421181680198;6.15733253736296;4.75456549025231;5.70443594007513;5.81703332390852;6.18142628910915;5.76118873878626;5.59540134012048;5.55255085248196;4.88063082531563;7.26991279650067;6.09108836813771;7.19258781399929;7.18469192340976;6.21135245267840;5.56774097131157;4.78222837108824;7.39250385459070;6.97820040798551;7.68245128595993;5.93456701053069;4.36302393352828;5.46340335815056;6.41461158474164;6.36270452237776;8.49555337907265;6.77360410818796;5.33376121466564;8.19392449705597;7.50158975133462;5.26364251279153;7.08112392559339;6.82408415672784;6.26206639595667;4.79071381346861;5.43363760980027;6.81439012841554;5.26713122927844;6.13062788608755;7.29032409510947;9.11233990076682;6.91663321672796;6.98190307099794;5.70404225846827;4.49272108466957;5.62581721860049;7.34463931117583;6.51841985673339;6.35038810021806;7.81997479457318;8.23247211237813;6.95614826541746;6.25197988023596;7.07024793379528;7.71173412087790;6.66557564238771;7.50724520822341;7.72365825672606;6.67777100387323;4.96297401793224;4.97431893672968;5.65470310372188;7.52208468799390;5.67615206117673;8.69016451278698;7.18207687478039;6.85141660802803;6.21528949716695;7.57689880836676;7.94535877105547;7.19810797527445;6.13042228984564;5.63512669035540;5.96249101525034;7.15176908572413;7.48606727926713;7.99412667472065;8.08771107356759;5.31871146218789;7.94025016454131;6.78238733456529;5.60020745576861;6.63421806513622;6.26355218240441;6.68611753686547;6.31330513126303;6.11152791469588;6.32802184076170;8.02628827513618;7.57299304455075;7.17026681050932;6.89644436615857;7.76076408340477;6.04231760097502;6.28949274286308;6.36818158933787;7.95003119105801;7.06060020661852;6.23592772996224;6.08895109097974;6.25474084456414;4.83029154269419;7.51307078372785;6.79348409844254;5.80677846369340;4.42302800449210;7.55848449383313;6.80474952170938;7.29064501568694;6.63065809655831;6.59768767122230;7.78762687407213;6.91507416362531;5.19769757478683];


s_jmt                = shares_RC(p_jmt,x_jmt,xi_jmt,sigmaa,index,index2,index3);   
                                                                           % This gives us inner market shares
cumsum_s_jmt         = cumsum(s_jmt);
cumsum_s_jmt_1       = cumsum_s_jmt(J-1,:);
marketwisesum_s_jmt  = diff(cumsum_s_jmt(indexx,:)); 
marketwisesum_s_jmt  = [cumsum_s_jmt_1;marketwisesum_s_jmt]; 
s0_mt                = 1 - marketwisesum_s_jmt;                            % Getting outside shares for each M*T combo
clear cumsum_s_jmt cumsum_s_jmt_1 marketwisesum_s_jmt 

%% 2 - ESTIMATION:

% Until this point, I generated the whole required baseline data, did some
% simulation to arrive at equilibrium "data" prices and market shares. Now it's
% time to estimate the constructed model:

%% A) OLS ESTIMATION OF HOMOGENEOUS LOGIT MODEL FOR "REAL" DATA & OLS ESTIMATION OF FIRST STAGE IV FOR "REAL" DATA & 2SLS ESTIMATION OF HOMOGENEOUS LOGIT MODEL FOR "REAL" DATA:

[OLSestimates,xi_jmt_error,Twoslsestimatessecondstage] = Estimation_OLS_IV(Total,M,T,one,index3,s_jmt,s0_mt,x_jmt,p_jmt,w_jmt);
                                                                           % This gives both OLS + IV estimates for "real" data
                                                                           
%For x &w unifrnd specification (all between 0:1), J =6 , M=20, T=10 and I=100, sigmaa = [0.2;0.2], IV = [constant A z];                                                                           
% xi_jmt_error = [0.668939689731206;4.15070882181434;0.923866727279559;-0.496840095148826;0.410982571084805;4.75069288456783;5.46670764123594;1.66570336403735;2.35482136400316;-4.25167197145268;-2.02376792553949;4.50651026518998;0.0870763378348389;-2.60851460004616;-1.46849129904590;1.01619900167945;1.69770032783972;-1.57935306422610;-0.842868561661605;-2.92385168255236;3.20077750622316;4.94258429225644;1.03340680853304;1.57956184830702;-4.42134078827084;1.28985916893945;3.39933915558916;-1.71544856760738;-1.90190997241931;-1.20214743967691;3.71757501654651;6.29545692256130;2.21046616396839;4.07267857728117;-4.17335593967685;-1.68040544971138;4.50507887641325;-3.74424073988155;-2.64081543303033;0.627456721536151;3.10777048901666;7.85619578041736;1.41573623629596;2.19655791847821;-2.37723316792250;1.01964972940305;2.98176801723993;-0.578039572544128;-1.42189806051321;-0.221701626131024;2.07979182665001;4.41662083811276;1.21830463674262;0.327829202273200;-3.81790026439623;1.18237172313254;3.46603179444815;-0.899940618542368;1.26051765236410;-1.95670955629643;2.62922406580688;5.82132042228599;1.02561723162918;0.708593723593082;-7.43257998024701;-4.07522534298768;3.52621918219766;-3.16611498749437;-2.05323708178882;-5.13544028458516;-1.21440507021945;1.36196891513336;-1.32382653593259;-2.63081043223212;2.58093742774198;6.28899117553192;7.41955871933712;4.84246135131066;2.80935757857335;-3.90699988909489;-0.0752207408727932;3.31056817388124;-2.31274006959787;-0.281451115115665;-4.25233570775749;0.143170443440265;4.03640353896985;0.241438305910000;-2.89082977430337;-3.12401006647948;1.70397501662529;5.29177356884631;0.991089324558177;-0.541456810889770;-3.79063704322068;0.708624592557355;2.56517964002465;-0.624985759238589;-3.27473206875299;-0.774224672040508;3.25942351651850;5.45637209468865;2.35506094825582;2.16244964989375;0.704955434507642;6.08993072461561;8.67994025385057;2.49280996602360;5.04006546525247;-1.04936057553965;3.07032188204269;6.59660461673618;1.11631728895714;-0.200654285396526;-1.22564109397388;4.44904392359530;3.73565758175167;0.0864146137373050;0.939915680654044;0.684651696493939;3.14969493368455;8.39311004363999;3.23174298120856;1.87487959140315;-2.45107812730682;2.76159297842313;5.97629149661529;0.665983772115108;2.17721992266219;1.78810953512484;3.56527624575290;8.16666923611620;2.52573544349266;4.39986276356115;-5.32193475276324;1.12769049708256;3.25905396691623;-0.793615985541079;-2.44214313226603;2.18926047779821;5.71577628067732;9.54103447183688;4.61005969992451;2.74322608590993;-0.355369937415226;2.03431205594910;5.30123315366872;0.537341644851354;0.951402185501447;0.559735389484849;4.67100607940407;6.33446278811489;1.97584997730181;1.76130773256694;-1.02987319936285;2.02764181637102;5.28261789556703;0.145898127354835;-0.611229720522079;0.0232852020435583;5.05851185692628;7.54615381004378;5.41595043210370;5.00956647587645;-1.77492362681781;0.767751583124732;3.22420347360178;-1.23502656149238;-1.64710534638096;-5.02398727442946;1.08255494698723;4.30793535055747;-0.667590730858968;-0.489681154012535;1.72706471447585;6.32565850650704;9.34247525926872;5.56667703858022;5.93555967420082;-2.32023978599315;2.44775137498598;1.68292884880024;-0.432605863938683;-0.525091096716563;-1.93180707317815;3.33484353917202;3.81362578780464;-0.132560866043194;0.797004693503307;-0.316068959079859;3.66559217524861;6.98980605830928;1.90103107859557;2.27255680028340;-1.49990985350883;0.220244904334213;4.38816292817261;2.40321628232684;-0.823547748215246;-2.89286642012085;0.757661735702692;5.30158579671269;-0.402781049388416;1.04122756329980;-1.96331381569526;1.48665398534448;6.91118598665069;3.23047756964598;2.24191424144377;-1.96113456505142;1.35422881697111;3.43288784311644;-0.483311745662369;-0.570311048334545;-4.44112271167219;-0.213869171890584;2.20492040874117;0.0590104727446859;0.959849890393005;-1.93009731964563;2.98502039649145;5.60824469860807;2.77716779871771;1.23505843602403;-3.00249388891385;0.844329958068543;4.29878622775751;-1.33826070999622;0.0283123714853968;0.880546930563279;3.86453892107032;6.19531303254971;2.33794357528682;2.32488896617871;-6.11320153461303;0.820933143452151;1.13961993395279;-2.54243684390983;-4.39150647260842;0.673836859677569;3.56126825918560;6.26591747753783;2.80622507816607;2.93868946417666;-3.59646565086341;-0.183248517220094;4.21041937827824;0.444881362588453;-0.319024975085080;-2.70258330249404;3.16881350724515;4.33509076567806;1.14213702299374;-0.584939119628287;-3.06539712099545;1.67687394443605;2.24291098703520;-0.510166386216422;-2.40346468970154;-0.102451987565406;3.84846422522926;6.20297983073919;1.14583915291646;0.724321152740797;-5.78341024563276;-1.96690882535755;0.571309489629677;-4.74905846123633;-2.58984932900331;-4.93643360540538;-0.456087619571267;1.96576172384817;-4.94561669807577;-2.38715940130649;1.21708002058731;5.89432883824057;7.11671477272418;4.46370813059879;2.96973025610827;-3.45425082526399;1.47685293861265;0.740094049149787;0.684924950586516;-2.05200669964220;-5.05590391738104;-0.513891704418175;2.71253316706748;-0.810560027563218;-0.953762372279230;-1.61707000191609;2.06380267972701;3.12359113741212;0.609079517471494;-0.184214519517869;-4.96108908621215;-0.203576712875327;2.96525000716330;-1.22525153485839;-2.80650653666661;0.292389105627699;4.70898823236591;7.38848805135699;5.19986015444999;1.81328937640196;1.94795361002237;7.27812844848235;7.57454359662264;5.86576576294243;3.67888442491913;-2.08821456920147;1.96821594128712;4.64024764938076;2.37504866835280;1.03250871501660;-0.670878135244131;3.98818478353479;5.53529205207912;2.86462487535636;2.02248174811694;3.36802446604521;5.23328422082816;5.92158350575408;4.20231559233703;4.70650981547801;0.407818739585897;4.88395579177157;4.96996656520328;2.51085402248763;2.38744058390787;1.91409954814455;7.87503568955032;7.06934034965613;5.05410157086967;5.40109857325419;-3.42245738557978;1.73657312225042;3.50540057130462;-0.615187944943922;0.137322511926772;3.95757909764262;6.51314371770908;9.48496798395602;5.26254186040196;4.18215814165101;-2.82718426537248;1.77749289593921;3.98967153469917;1.06851450721997;0.901207569047715;-1.20699041659432;4.33031742361901;6.08861992719330;3.20383362321077;3.07014311732267;-0.207760848701861;3.39630453986528;6.42923382194651;3.73711223217643;2.80979116659265;1.96750594280433;6.56794028753827;9.14884990394167;3.26460630400447;3.88738696242157;-4.01608175231739;0.136636093580913;3.04310713365907;0.405144792530075;-2.54338702142071;-3.68567448418178;2.45358950589054;5.15201726946409;1.95984004094420;1.52073876310070;3.63581227059408;7.82333766511098;11.8169491171724;8.35461471015601;5.68299107062484;-0.641978352815384;2.06010156868516;4.88840286217425;2.10522969097782;1.29593725147296;-2.73769303212259;3.13978159589892;5.60733336083509;1.75850313235488;0.145027617905162;-0.392286548284606;2.96997769559987;5.76891951919327;2.19225301541071;2.23899886526336;-1.22798797921197;3.84430169586805;4.29997575299538;1.99422935106216;1.93418229412730;-3.53537150165074;-1.13091690117311;2.77211614588474;-1.43594905792494;-0.769501496544306;-1.93349706715525;1.42590964048913;4.37118470422581;1.04999666853988;-2.28118117370476;-6.16540030845068;-2.12708887609228;0.0106631275225704;-4.73859952694517;-2.76565243365643;-6.90289851788781;-1.04344743348419;-0.295052638593656;-1.65670021708372;-2.57199406573022;-3.01415871357212;-0.786998589128826;3.08922584326762;-1.16664994709457;-1.25254204342361;-6.15813226651442;-2.92829092453620;0.402062461168126;-2.80388772447713;-4.39001083390072;-2.32723476018314;0.263959533395092;3.31994956481888;0.220726146389783;0.261846128525268;-10.2685708422435;-4.89653551201472;-2.47925288598384;-6.14809943995665;-7.09244648007382;-2.53294509729330;1.44839809361986;5.61563934690147;1.14536899943145;1.07224520570367;-6.58528992220819;-4.48755887537612;-1.31680291317933;-4.18530799372895;-4.48452504551876;-4.29613667567373;-0.762565568828126;1.53889484005549;-1.06348896704609;-2.38703266141361;-7.51571643920236;-2.57968214867695;-0.0470801749884400;-2.64979345058672;-2.95162995210246;-2.55149426693193;0.477821589625424;5.07743275384104;-0.00910330400963400;-1.28820143806104;-10.1996473975681;-3.88067362068352;-2.00680426009460;-6.79679545572462;-6.03009173005259;-9.41846593400403;-2.77648174720036;1.24443043037243;-3.74827327723729;-5.04807306116365;0.0435910581927192;2.99708464500168;3.09208786308431;2.05701608698273;1.97643383536156;-6.61615024957487;-3.50601405961415;0.287284498106715;-5.44449044278931;-2.35342195854346;-5.50037286636373;-2.77404806873018;0.0484948148861299;-4.21048840035901;-4.96598691155814;-4.95646839461575;-0.126211894893727;2.57317599498181;0.633523934335250;-2.63456594091760;-6.93654996094732;-5.45267793606908;-0.634658201537206;-3.60381984979353;-4.16961875870971;-4.17300703173986;0.115358384406855;3.54798745978840;2.58900156678912;-0.888584716634402;-1.09955897366070;1.11567892655698;6.38582297411081;2.58812275145139;1.43299345250017;-3.91266498372338;1.57915415434980;3.58690510267559;-0.667698159090617;-0.705611018338065;-3.22863469305045;0.526926744533265;3.09077232474612;-0.646071220670539;-1.39947989473683;-2.97697462157140;2.80523766407850;3.19722245395158;0.00225005922550459;2.29556625951256;-4.63246056755823;-0.259837918486162;2.48817733984706;-0.696717494689425;-1.63938646027155;-1.46118693427348;0.718742232504691;6.23217546515308;0.661102529176243;1.84790392449941;-5.58682925180428;-3.00822733696621;1.10352076917580;-2.79757680847205;-3.24061128985310;-0.767290226968207;4.70480968778122;6.58578559570995;2.38857830581634;4.04672270225888;-4.57579449917673;1.11626670111999;1.95417833391143;0.0334494755996193;-2.18269339976856;-3.80100368202107;1.77493990642473;2.19205986105285;1.89830886026770;-1.01001404926375;-3.65461731026276;1.31258863068883;3.05112706410063;-0.261859310665210;-1.99658729569650;-2.19099106863151;3.70925695824336;4.27391745871178;0.760449576223236;0.777097518031603;-5.70862158677292;-2.35479790521307;0.264811168267300;-5.28999447489960;-4.21819774180172;-6.49925151429491;-3.28081203291095;2.54484338789796;-1.52447359881577;-4.49393506921051;-0.0590269622602673;3.76549691213239;6.77973213300665;3.30088424008775;4.48971218944537;-5.01192440808285;-1.25061889327810;2.24071603579241;-0.877557872758665;-2.67548188118130;-2.52767197272194;-0.660786919726569;1.28049734915018;-0.851213487329482;-3.25124553936257;-3.26504489273442;0.838654630189835;5.34542969810408;0.660865122758850;0.595343666632442;-4.49456791601050;0.220970228490494;2.23774640555479;-2.89789592413507;-3.92180063552230;-4.16506949267209;2.51141504761601;3.45089414425305;0.664759000398341;0.428883646821983;-2.29269058172781;1.98478733954274;5.17595422204001;0.996495448954458;2.74713951477257;-4.26675373688559;-1.22627221073840;1.12931004995228;-1.09664318145057;-1.72657583625704;-3.60549495197157;-0.0653335570747791;0.000455811779590754;-1.86211898850385;-4.11791113688436;-2.85368848101012;2.29359712634176;4.17546645726105;-0.876224394831859;0.727396459674505;-3.92151145494376;-0.744536684649792;0.655443974854323;-0.513806925114634;-1.86648327669536;-2.44376480979744;2.23645812572558;4.60407549936164;-0.00591526101618367;1.63492350556275;-7.21318588532129;-3.77876687556696;-1.21747419404139;-2.83724641786439;-5.41544905987934;-2.28015299441988;4.28890411576167;6.05702609136091;4.24042249004500;1.70326248250529;-4.91039425403084;-1.97840695920255;1.19026579893502;-3.81582746443548;-2.18099619750252;-2.69413450118410;0.992886346051384;3.36126939929041;-0.685207939771196;-3.13212693008772;-3.93206713103171;-0.452327242878555;2.00044835758915;-1.38417711446471;-2.11086978440721;-1.04395846056121;0.370840048629495;3.24918842224569;1.91862395256153;-0.381902504387014;-6.43567488667158;-4.72076421353971;-0.480868088415015;-3.20080510245256;-6.76304335504110;-7.03768427360273;-3.23176755969137;-0.587695934451344;-2.73940178114918;-2.54930037010675;-0.609276379130242;2.93174610249175;8.02112365016942;2.65535170126860;2.56527617200087;-6.94394958055414;-1.02083853473386;-1.22288277031342;-3.31352657731079;-4.80491286223120;-6.37949256185497;-0.911205263379372;2.91549743259096;-2.71307998028969;-2.68796346685677;-5.26638386123396;-0.125523869533128;4.73497796298849;-1.12141579681438;-2.17105444673444;-4.91245090418734;-0.838097337172766;-1.11716725902850;-2.98117287009866;-3.83692897806342;-1.59307502921525;2.88003730794384;4.83753792436230;2.08208886652923;2.04475210605659;-0.293515098628560;4.72456255324365;5.84021013741107;3.86744844904303;2.50331206772254;-2.20200212892013;0.693674853164203;4.49413332355349;-0.179916436738124;0.0117926923559191;-3.83275754362297;1.70944830844462;4.90286205729034;0.933617444734325;-0.572465756146023;-1.33306966168252;3.17241143638011;5.38758577377419;2.42670727713482;2.71062623969065;-2.48335629797742;2.86577825317842;3.30219244625396;0.961373977510965;0.659068459577700;-2.21098861262863;3.87376569821524;6.85238510250671;1.63348159044905;2.02402899858652;-5.93037716968690;-1.97182453434640;0.641992991235762;-0.966567098165652;-1.90670498202379;0.609719384555164;3.85477911206742;7.26412472420472;4.32584301920540;2.07258022881598;-4.11219433728851;1.45706169385486;4.82137799187543;-1.25097470077046;-0.154077043257852;-2.93689873581289;3.21013555934627;4.68596121399914;0.416931220287414;1.80104142945337;-1.50145144360331;0.998248835181290;3.43909678742698;-1.22523699863504;-1.28087325083009;-0.401013251786193;3.76257790207762;5.63572050672104;3.68914757342646;0.735214898013330;-3.77065847942442;-2.77894369923069;1.26157552969518;-0.849809915074752;-2.59737323804059;-4.26376305058117;-0.728753393252983;4.46884234917075;-2.11012599440810;-1.07162798251281;3.27659160267569;4.90909943711423;8.58472037366161;4.85935827362299;2.63581282700539;-4.51084853072536;-0.392653059721468;2.95740097554658;-0.200181939216380;-0.870492116921388;-5.12192821394037;-0.679092457513858;4.09960000035486;0.510672224490353;-0.458263845802762;-1.06052174866235;4.28705528628742;3.91070840326599;1.19592360164474;0.722887978465925;-2.85240118889622;0.997015503396792;2.99611417956471;0.395997272748880;-4.24663934213150;-4.67285801521949;-0.381419731136504;2.10489014296794;-1.63416737373800;-1.22892959064642;-2.90981402064524;1.87011062420078;2.49155332204522;-0.302985605581832;0.724124132284761;-5.66874527011303;-2.14407871223462;0.107619074843056;-1.96175296762791;-2.86391908290495;-4.42471503388755;-0.788588488324397;-0.559722732558063;-4.90442390491962;-3.36131214184978;-3.97882990200558;1.47545715111152;4.24031320634556;-0.205880297138696;-0.721215044482639;-5.88923621077065;0.0181982769663334;0.944023194744452;-2.62450518239214;-3.40069088020054;-1.54998727354296;1.16887337821748;4.04264813331913;0.718850170211216;0.286396516137630;-7.65129035918655;-3.94342054154133;0.154124958737413;-5.02708051716846;-6.31202913836178;-2.13207585402563;3.36691734437377;5.50086384131484;2.56266933847215;0.688224437525947;-6.56538341687694;-3.90365622001076;0.919952880212299;-3.39168375544506;-3.12705581629489;-3.25659979499189;-0.307997164530065;2.95911410113657;-1.05898873449797;-2.07797805967372;-5.52820439983385;-1.92203120584056;-0.539448196107805;-3.38441710820746;0.0744117988251389;-3.16649770793253;0.970424578102642;3.45614426785950;-2.08244767700466;-0.745519199118508;-11.0848554303611;-4.87541735121336;-2.48190034697281;-5.00354194486699;-4.46432918034170;-6.43787550199258;-2.92980793687787;-2.00686219993467;-4.51883705385354;-5.96141666468244;-1.32091152263981;2.03633144431919;6.38870528851808;1.48012248487023;-0.551594733550411;-6.86853417047853;-2.10884988428074;-0.694746422591662;-3.33582044757086;-4.37640117428469;-5.41839517292420;-2.69355247154491;0.298443806242286;-3.07080305705511;-3.58423513327153;-5.86455244444221;-0.225910475427957;1.16748396354794;-0.793331357861442;-2.98833305495155;-4.95749025826452;-1.67432542840062;-0.396750193952721;-1.44652764055509;-2.87920172028909;-4.41988530224996;-2.43099051737743;0.741192231933351;-2.62564234306365;-2.62091086004252;-5.74675241675340;1.37207853529767;2.87356757268308;-0.511713065485994;-1.86861214238078;-6.25912879624054;-1.05884226274103;-1.44164109141805;-3.92292952899611;-4.61447946390037;-6.44060827564414;-3.40005059343954;-0.758197641296761;-2.88105866926480;-5.39039929472004;-3.00713836176819;0.560369476665305;2.85314662107931;-0.795287846201930;-2.52571336445213;-8.08453564803723;-2.35944835648089;0.866423093236262;-2.54731877353103;-3.62420330214108;-1.33192663465528;1.30880823284648;2.72845386744380;-0.119959456716788;-1.43737910152228;-8.99891300857174;-3.79284130860916;-1.45228349178224;-5.59301068355641;-8.07866958884461;-3.61341186280959;2.15380981777119;3.71017793214253;2.01432196923190;0.772913637037998;-8.34570329043176;-1.88457845217890;0.283308530722695;-2.68597240573139;-4.36172856828738;-5.19061953069069;-2.50163641617668;1.04610286667422;-3.17800158503646;-2.83010440965368;-7.66018779333797;-4.03144454193752;-0.0409314385184256;-4.26913709376967;-2.58371612202725;-1.93651400340499;0.367524877583594;2.81639719231962;-3.00084556943797;0.632159982733794;-9.89424832980404;-4.38786733348953;-2.19829002085605;-5.36484039928835;-6.17808343588923;-7.86888622345830;-5.02505716761104;-1.33409928765864;-6.65860087399514;-5.69586296000160;-2.22556329155553;1.94230778978387;4.89829510418961;1.84421161389767;-0.645451490789649;-9.36754488869685;-4.21285153342838;-1.01040543602469;-4.58690641691372;-5.54186478308255;-6.58993539330706;-0.922222739506823;-1.18521196121972;-5.06096343031470;-6.61763767137838;-5.32055298044704;0.0335029239574287;0.336637263662870;-1.41330984912858;-3.19883541018129;-7.48578774801703;-2.28525472345440;-0.539566462359508;-3.88812658546930;-3.27414543419996];



%% B) "BLP" (RC-LOGIT) ESTIMATION OF THE MODEL:

%% B1) DEMAND ESTIMATION:

REALDATA  = [x_jmt w_jmt p_jmt s_jmt];                                     % THIS GIVES ALL REQUIRED DATA FOR BLP ESTIMATION

A     = REALDATA(:,1:3);
z     = REALDATA(:,4:6);
price = REALDATA(:,7);
share = REALDATA(:,8);

constant  = ones(Total-M*T-1,1);                                           % Creating constant for regression   
tol_inner = 1.e-14;                                                        % Tolerance for inner loop (NFXP)

Kbeta     = 2+size(A,2);                                                   % =5(constant&price&prod. characteristics) - # of parameters in mean utility
Ktheta    = 2;                                                             % =2(price&constant)          - # of parameters with random coefficient
v         = randn(Ktheta,I);                                               % Draws for share integrals during estimation
%IV       = [constant A z A.^2 z.^2];                                      % Instruments
IV        = [constant A z];                                 

nIV       = size(IV,2);                                                    % # of instrumental variables
W         = (IV'*IV)\eye(nIV);                                             % Starting GMM weighting matrix
init      = rand(Kbeta+Ktheta,1);                                          % Starting values for all parameters; serves to simulate them uniformly
opt       = optimset('Display','iter','TolCon',1E-6,'TolFun',1E-10,'TolX',1E-10);
% options   = optimset('Display','iter','MaxIter',100000,'MaxFunEvals',1000000,'TolFun',1e-12,'TolX',1e-12,'GradObj','off','LargeScale','on');

%x_L       = [-Inf.*ones(Kbeta,1);zeros(Ktheta,1)];                         % Lower bounds is zero for standard deviations of random coefficients--
                                                                           % (for theta_2 parameters)                                                                         
x_L = [-Inf.*ones(Kbeta,1);0.2.*ones(Ktheta,1)];  
x_U = [Inf.*ones(Kbeta,1);0.6.*ones(Ktheta,1)];                         

%x_U       = [Inf.*ones(Kbeta,1);Inf.*ones(Ktheta,1)];                      % Upper bounds for standard deviations of random coefficients--
                                                                           % (for theta_2 parameters)

iterativedelta = zeros(Total-M*T-1,1);                                     % Creating a global variable for delta which will be updated each time 
                                                                           % in contraction mapping until a fixed point is attained

Indicator      = zeros(M*T,Total-M*T-1);                                   % Matrix whose rows consist of markets and columns consist of all products: 
                                                                           % It basically assigns value "1" for products present in a given market, 
                                                                           % and "0" otherwise. 
for k = 1:M*T
    Indicator(k,index3(k,1):index3(k,2)) = 1;
end
%% % FOR J=6;M=20;T=10;I=50:

tic
[X,fval_rep,exitflag,output,lambda,grad,hessian] = fmincon(@BLP_GMM_demand,init,[],[],[],[],x_L,x_U,[],opt);
toc

%For x &w unifrnd specification (all between 0:1), J =6 , M=20, T=10 and
%I=100, sigmaa = [0.8;0.5]; IV  = [constant A z A.^2 z.^2]; 
% X = [1.68641905463461;3.21008737006239;0.410256327877981;0.718497005416562;-1.41113072804218;0.00423320852246307;0.000550109807861144];

%For x &w unifrnd specification (all between 0:1), J =6 , M=20, T=10 and
%I=100, sigmaa = [0.4;0.3], IV = [constant A z]
% X = [2.83627713944041;3.38941308069471;0.473395328847145;0.718231718648966;-1.76990598725139;0.00136671448132476;0.000245037095879374];

%For x &w unifrnd specification (all between 0:1), J =6 , M=20, T=10 and
%I=100, sigmaa = [0.4;0.3], IV = [constant A z A.^2 z.^2]; imposing x_L = [-Inf.*ones(Kbeta,1);0.2.*ones(Ktheta,1)]; x_U = [Inf.*ones(Kbeta,1);0.6.*ones(Ktheta,1)];  
% X = [4.21322434340487;3.45482602995019;0.550081944042287;0.724840600331336;-2.06591613850779;0.200000003979628;0.200000000034696];

%For x &w unifrnd specification (all between 0:1), J =6 , M=20, T=10 and
%I=100, sigmaa = [0.4;0.3], IV = [constant A z]; imposing x_L = [-Inf.*ones(Kbeta,1);0.2.*ones(Ktheta,1)]; x_U = [Inf.*ones(Kbeta,1);0.6.*ones(Ktheta,1)];  
% X = [3.44779691233060;3.41741680322011;0.526570207267029;0.720258864258269;-1.90484942306951;0.200000054990292;0.200000001267575];

%For x &w unifrnd specification (all between 0:1), J =6 , M=20, T=10 and
%I=100, sigmaa = [0.2;0.2], IV = [constant A z]; imposing x_L = [-Inf.*ones(Kbeta,1);0.2.*ones(Ktheta,1)]; x_U = [Inf.*ones(Kbeta,1);0.6.*ones(Ktheta,1)];
% X = [4.61983122687729;3.49730845065532;0.606786971286053;0.727281727081031;-2.25171306341939;0.200000015467559;0.200000000620828];

%For x &w unifrnd specification (all between 0:1), J =6 , M=20, T=10 and
%I=20, sigmaa = [0.2;0.2], IV = [constant A z]; imposing x_L = [-Inf.*ones(Kbeta,1);0.2.*ones(Ktheta,1)]; x_U = [Inf.*ones(Kbeta,1);0.6.*ones(Ktheta,1)];
% X = [5.01791589789144;3.51167680106441;0.595825033142543;0.734627770675143;-2.36672811365491;0.200000038908743;0.200000002183546];

demandmoment = g;

xi_D         = error;

%For x &w unifrnd specification (all between 0:1), J =6 , M=20, T=10 and
%I=100, sigmaa = [0.2;0.2], IV = [constant A z]; imposing x_L = [-Inf.*ones(Kbeta,1);0.2.*ones(Ktheta,1)]; x_U = [Inf.*ones(Kbeta,1);0.6.*ones(Ktheta,1)];
% xi_D = [0.229963268132488;4.30146438985339;0.658833634368339;-1.00137814282438;0.820626140841510;4.58820926518791;6.18451776083717;1.61119994677521;1.92223210000232;-2.96653858369942;-1.43151870540822;4.19023539051551;0.122039320557579;-2.98424424943840;-1.42316418965830;0.388401781078406;1.33204747254157;-1.09166374040874;-0.589591826961579;-2.45049788569856;2.30281660940172;5.43469371552073;1.59165554275340;1.71857660769618;-3.43910747814917;0.678051759296637;4.44569460047108;-2.74670023164673;-2.28385495507088;-2.18827754555239;4.40928447804360;6.56872609996586;2.19530146033416;3.34713949019302;-5.84017363153381;-2.22704154831672;3.63034537092255;-3.16651603084345;-1.92428140120548;0.105516426286132;2.91936772512467;9.18803609261572;2.89080741855784;3.70219104046961;-1.94162474141131;0.494005733828405;2.61639657338321;-1.63973693770176;-1.09552018883540;0.314128467613504;1.60348943110420;4.37817542625514;0.928184087306307;0.601359479155880;-3.63782598629043;1.51440529257332;3.30120986602077;-1.22949664654236;0.644566369573207;-2.00223852393387;3.54932261369027;5.90562845669338;0.198317639432293;0.379545965969585;-7.05221894948569;-4.30768003305945;2.96903493523401;-3.09046859999904;-2.15743882058590;-5.13006187931318;-1.54573955080687;2.05710180181705;-0.905072440317474;-4.22908248480538;2.15457279465306;7.12427057084411;8.27633468311408;4.97280429396478;2.76781328467361;-4.34414266511788;-1.13018392199216;4.00469557004901;-2.73990513627683;0.283772320018256;-4.07114683773956;0.609325963687978;3.58575877520221;-0.142530711471766;-2.27442962036715;-2.83191239804510;1.01275019503665;5.54947713146681;0.419659950395436;-0.00968826138565859;-4.68790085371585;1.27942360686742;1.67642613125676;-0.515216644006214;-4.50697441404013;-0.830707103536246;2.73226122156675;6.33203922967111;2.18025843214793;2.43964796788608;0.939188747792613;6.69959202429109;10.1527226537814;3.44830597996495;6.12289980540409;0.220076234103841;2.80510771515674;6.67315307810993;1.86842648736688;0.450310920424823;-0.920448192203582;4.62427049728326;3.44189868463633;0.437998680966169;2.28362616586277;0.697445125369088;3.59377738378751;9.14409303511289;4.09812458734783;2.82301137042946;-2.20031107974342;2.44429574948121;6.19778174928574;0.613683496187123;1.20349713839582;2.36616947465766;5.27958920764359;8.61262814895466;3.29263569011948;5.11952103632397;-4.50865479692661;0.658799453384551;3.01497035470917;-1.62873182332431;-2.77900632291980;3.80281211478340;7.08008995576302;11.0626097221457;5.75531714262892;3.23664806469898;-0.309613690847744;1.47913770203159;5.59814387907931;0.410408994482806;1.52761405937120;0.424734031380455;5.39169729001354;6.90404253453805;2.97456013698272;2.93571660038576;-1.85207928627186;1.92675658290394;5.74605464203394;1.00172534159301;-0.769194063381232;1.45349348560456;5.52971890203416;7.94664100135992;6.02204181275462;4.69919482973767;-2.24234883728923;-0.120196779761773;4.03229389539222;-1.30422451359954;-0.739367636092302;-4.96747775860952;1.24568704328393;4.21455006421433;-0.954046998182774;-0.389191955442875;2.49262065711768;6.30484396220326;11.1442993229176;6.46487245006037;6.72581436609587;-2.86125563903754;2.58252963671110;1.00936423976046;-0.411095420674913;-0.380093889393701;-1.82905800851951;3.10293375598969;3.50454950050012;0.472216020515056;0.0272935872516165;-0.0286056624206017;4.03137345674841;7.59116569409967;2.06370654756926;2.70944971659283;-2.36499922349324;0.204859915851724;4.64981444859978;2.30429897826516;-1.45887228154476;-2.88164297760528;1.25538748259437;5.50405544446057;1.01638837520649;1.59197301468780;-2.27297211413309;2.57413299201412;7.66545254110200;3.79894874440757;3.33072151063378;-2.31049167308779;0.953492246727056;3.58841334686778;-1.28024291374687;-0.736747451071810;-5.22038920903804;-0.0744670833551364;3.08733777701246;-0.341508589205706;0.432578548290088;-0.532341257287252;2.86496556084812;5.68936873555446;3.29981070514310;2.01624947200819;-3.98771118807517;0.379882852967486;4.23752142602190;-1.72898368527921;-0.844089770172859;-0.441733977790472;3.14414992199795;6.80336485091561;2.84211587523080;3.17957962244048;-6.79833706466781;-0.856711612206892;1.15920641382253;-2.69157380368914;-4.60572209198718;0.495073020048611;3.49334949584696;7.37428764828966;2.57263590458842;3.09724387424281;-4.94819287181706;-0.945938664859131;3.78483373804043;0.382996295805308;0.0300156141192129;-1.00763454119754;2.53526500934796;3.48626232087766;1.13674106687696;-0.806459400651533;-4.08385517528106;1.94311170708843;1.68687650697829;-0.754130622514798;-2.74268340794233;-0.477300629886499;4.35393881864419;6.92727934974237;0.852849495180676;1.09275822648511;-5.98525493826628;-1.62217772826026;-0.0233019570706636;-5.52940839939394;-2.42350428399338;-5.29126680983748;0.286814683161856;1.87839598092074;-4.85793191811397;-3.09914367201473;1.61776621483703;6.42422073676667;7.49169018266315;4.82391185724474;4.58412138674377;-3.99954846184825;1.05814671097268;1.38941507797682;0.262666726704102;-2.27563210677292;-4.82531525006298;-0.734997774468020;2.42779316745866;-1.18186227926460;-1.26854344789407;-0.999471288136167;2.76998592751059;3.10034438070762;0.292340506249934;-0.435527531092587;-5.04273215161448;-0.165458331411431;1.96604714071159;-1.83115378920347;-2.80009491295156;0.695097298525168;5.84577247679279;7.25712189113562;5.53976425934091;2.94256202786338;3.44293634446968;8.13829926034605;8.37709247074900;5.41511694067310;4.45715179993550;-1.24704067636402;2.15902705823056;4.84784206155763;3.34320875794848;2.16463835861066;-0.461301526663823;4.62523015621529;5.95188713907017;3.26703748246636;2.99823752842260;4.09461508560541;7.16457315459234;6.44425443515548;4.89475874999662;4.98885617797258;0.220604290970550;4.42205004486480;6.28332150317332;2.55379840877176;2.60575933524637;2.79331223822510;8.72983745665592;7.78853680491831;6.66936550940548;6.61765387074739;-3.34850873735979;2.00106388535702;3.88123807916648;-1.01909976296660;-0.473892052003128;4.88518820141800;7.23802524071192;11.4117293784526;5.22158563576338;5.60001109372305;-2.34730276057003;1.14197663137669;4.61221736503658;1.15318060639670;0.564129918913156;-0.693257237801481;4.59843909692852;6.82607656072405;3.27175214796412;3.23782368839973;1.18659962784634;4.19952884432028;6.71994626056824;4.16471664611294;2.76294843156573;2.06467942801456;7.29592830738863;11.1787875753586;4.91803415650995;6.37433554432091;-3.57922904806244;0.138839187286212;2.71349951295157;0.402572352803745;-2.11101448074466;-3.96122147920433;1.76447807278394;5.70310814686052;1.70241637306682;0.723260455014242;3.72555048088964;8.92592124424908;13.6457524412067;9.52773726237723;6.81636655670037;-0.568978591186482;1.50931203812384;4.84238944095200;0.758239279493310;1.31349921644262;-2.91275842141974;3.59815191968333;5.48734276013712;2.44991185897775;0.860666657627561;0.0574506771257539;3.05411647836344;6.38058716816242;3.21779120726805;3.23825019056312;-1.39117518020932;3.36928138425674;3.74033126626289;2.01952133712846;2.51110267950236;-3.99576909470355;-2.27861749841251;2.91556242825107;-1.87839774702273;-0.466678686616518;-1.70548387251977;0.674782872333452;4.41505358656879;1.27517918236913;-2.63609290162869;-7.32653914894892;-2.29762450224149;-0.851666002083825;-5.39447388424937;-2.29362247936729;-7.61296968598685;-0.963980811780715;-0.958245665551878;-2.72737289925891;-3.44641579095260;-3.92758408149774;-0.576296110432676;2.55186017917284;-1.04934430424671;-2.95504400210208;-6.47851428759361;-3.47247884336929;0.619023119417953;-2.91843368780501;-3.84996237217967;-2.50856041762234;-0.206312283251568;3.37356787296287;0.637743129621780;-0.272875048646431;-12.1203609573650;-5.22789169189153;-2.62532551166158;-5.84993783167693;-7.42925853265916;-2.01582508895451;2.30324432157561;5.65053055120959;0.482735735886119;1.10152462954246;-7.82079986321638;-4.64144704002554;-1.82215511437565;-5.06952447031067;-4.80084292406763;-4.39152086359283;-1.09331788647290;1.41992517661052;-1.15384008349026;-2.39293498570130;-8.11300246712683;-2.33097578727028;-0.773769919316115;-1.99553041449072;-3.56661382828924;-3.39180436517554;-0.114041318931768;5.06173224216850;-0.395555746335997;-2.21771662928928;-9.51554106308012;-4.10379528560365;-2.90790087523676;-6.32856719526227;-7.18940242267217;-8.95760192105962;-3.13331396347725;0.619049751140802;-3.46159924980637;-5.53927876668619;-0.127873055243767;3.24315356729584;2.97597427110920;1.50526718656289;0.928304996136635;-7.71474944785898;-3.49235508716126;0.295094282112352;-6.05407596991710;-2.10764078816339;-5.63189863969414;-2.66694059565263;0.543425753242902;-4.86073562652457;-5.37198034111897;-5.17325557492205;0.408974010170223;2.48333273265811;0.180665735388965;-2.96813653368659;-7.88890945692562;-6.05079506263678;-1.16279886664423;-3.64512577692068;-4.73368554126731;-2.99386063401715;0.261090492013995;3.13344111016158;2.95541419648214;-1.03167949551889;-0.594709860003604;2.73800353882107;6.99946653110321;3.26762121092299;2.00453168267216;-4.40412009104407;1.92023997866050;3.20113601793749;-0.750582804684969;-1.34392761653820;-2.65390531909525;0.903932083961458;2.43248747765285;0.0339629170550513;-1.73934726634345;-3.01688481674751;2.86836463289899;3.27456194369245;0.973863215498309;1.36470345733796;-5.10928648567043;0.775167224826072;1.70705413771149;-0.284686630991443;-0.148711512634286;-2.34662061473390;1.28391149943075;6.45718893854254;1.65721993596855;1.39791629504723;-5.65088071917076;-3.67630474619727;1.45808658377097;-2.86091673402270;-4.37367544153455;-0.708260128277760;5.54504475023183;6.74777594558444;4.07333775311425;6.04473407958152;-4.25526208391466;0.319693494650021;1.74960578022709;0.412209637009253;-1.93860037591150;-3.68365767220481;1.99664513087414;2.39876578767844;1.71458135377380;-1.12384586624193;-4.16159192751076;0.958748604978442;2.90799750677852;-1.09513546005941;-2.62880280563787;-1.65819521870658;3.63887450964979;4.23883605776335;0.0813376635376679;-0.00434880738375165;-5.54461567614609;-2.95643307956821;0.315546869841548;-4.55817062813916;-4.66265405476384;-6.40286083228697;-1.98758442405877;2.16116385845467;-1.45222475143593;-4.69083103508465;1.16618900577291;3.80560012088987;7.20814068712387;3.88274857454866;5.00981439758692;-5.52839989627942;-2.61831013011493;1.48365515083414;-1.52106568399807;-2.29674557252791;-2.58125477501282;-0.848735794056775;1.26968479257010;-1.53164717568563;-3.29097066440433;-3.61158634856973;0.851650358966881;5.07741551521389;1.40677544370495;-0.354056932571556;-3.51327555663098;0.134117897465829;1.24035768843767;-3.50465438729397;-3.90948163505442;-3.37599619023599;1.89370926938041;3.52108850821435;0.293018818692531;0.906010091880475;-2.72996098614941;1.28396962001801;6.27034968228871;0.953385272680537;3.22482955487606;-4.05584233793697;-1.75371164115206;1.41851384977041;-1.43590100202698;-1.56705581202295;-4.67318050158625;-1.36622004717876;0.0654824401400918;-2.38141433971726;-4.79130290092188;-2.29327384300991;1.14122760481975;3.71588753821238;-1.04419389091591;1.21804914962532;-4.12208641166536;-1.88990984374241;0.124255529067706;-1.32962556803565;-1.84119020978345;-2.31662889788620;2.03111638471050;4.81624075542959;0.785172269273694;2.45217999453462;-7.10693368064202;-4.69899916846268;-1.91813059910020;-3.48924340361844;-5.44757234793957;-2.10519989100663;4.48116337632385;6.41082734983731;4.64099462140548;1.16995282138361;-5.26901058696142;-0.931731977967347;1.65676007016743;-4.32878399012956;-3.48480465377046;-2.99135864458498;0.677476134799295;2.24090668088030;-0.163023373593667;-2.67626560037782;-4.12924905680130;-0.857435659385499;1.83636396478109;-1.34980064095203;-2.45617734251933;-1.40509879653187;0.589478904052923;4.26463516767628;0.910408396368253;0.520471476771270;-7.33836368532452;-5.29079530930588;-0.473669431832899;-3.09816543109445;-7.42491080788971;-7.46358744342091;-3.75753563100344;-1.35923759456767;-2.70781882969362;-2.98330805856188;-0.684847781309331;3.87016496058461;8.71371584531197;2.43649508945286;2.68306529812847;-7.24703224708356;-2.05300367768884;-1.28627984604718;-3.51510565716627;-4.90812607330671;-6.20313641509761;-1.26860542838439;2.59598615726235;-3.43475802473957;-2.53071346828674;-4.19528085660009;0.397292738914096;4.96907558297962;-0.809228119094954;-2.14994650932051;-5.11699317131312;-0.741561906068922;-0.968459309388749;-3.43532214439720;-3.89875535868368;-1.96427089811983;2.72131060751570;4.79642402331795;2.28643964937436;1.59098276686908;-0.434992713370493;5.09067546627422;6.07294196613188;4.21708503597500;3.30409892901592;-2.30350821778030;0.500740077738510;4.68143960693610;-0.0482776987450650;-0.288182002732341;-3.56117366402589;1.73176360537986;5.12616335627007;0.211934247626344;-0.131486888530919;-1.65189415276425;4.16088369520441;4.95202364656487;2.49828210091051;3.29036028954600;-3.08338659938472;3.02565504920920;3.38380752491338;0.795377652441587;0.191980506263673;-1.37584793098093;3.54814029611840;7.74487105653531;1.97886901903710;2.41297127585220;-6.56041533919207;-2.30875614635743;0.0202694303158024;-1.48841571626265;-3.29854502017654;1.32524722873516;5.40409411329978;7.61889890576134;5.90509934261699;2.58555839739854;-4.49784005111503;1.27253964835175;4.75910947579324;-1.00212599351392;-0.905699983717429;-2.82940855289530;3.64913439576635;5.08501661892294;0.746848011535887;1.51151274318091;-1.98565023392599;1.17528174433600;2.48368435636292;-0.573922605209777;-1.97392752477318;-0.0504772458318854;4.99623369166208;5.67017913365697;3.26957594721109;1.29507471425331;-3.93108357639073;-3.00702158951753;0.763406245189045;-1.59810085691575;-2.36194447003001;-4.92859967423101;-0.346093549474105;3.85303178735294;-1.54207996997372;-1.17688887076923;2.29945717073859;5.59851378466053;10.3420384201518;5.36765910042767;3.12267977123939;-5.04343839249888;0.158953841968030;3.31530811991955;-0.159624766357272;-1.16733096483789;-5.02982585275298;-1.21124760306699;4.31785514766736;0.538583115915408;-0.436716068596672;-0.294856345845332;4.00648512951065;3.53556134279370;0.783788699987924;1.14432476402558;-4.41766639318337;0.614753972305076;3.49027750838355;0.178922133115178;-3.77355742640834;-4.52497843950790;-0.137202739536338;1.03255123624761;-0.110238549491330;-0.738908492230957;-2.62958429443673;1.94803688720643;2.36894953429520;-0.840166149144851;-0.890232573857920;-6.42497537242706;-2.51084529035921;-0.622113266529317;-2.06050988058554;-3.05073339737093;-4.81839402659521;-1.71345200580488;-0.336901658769355;-5.25878402047814;-3.28980124446181;-3.92215574152427;1.01693818677275;4.11539099327073;-0.464611138328745;-1.19161903575524;-6.79532453344503;-0.313158754049688;1.18575040421872;-2.76374309529927;-3.38668816364356;-0.965194295381306;2.99741136676239;3.90025799599431;1.04312377890856;0.146314006730987;-8.23065220605090;-4.21807732986411;0.289766070926003;-5.64224508005133;-6.45802916215321;-2.17358254411610;3.46364492648157;5.45095070009383;2.17684634806603;0.0394410989853249;-6.33760412529181;-4.44240023085248;0.665516801597807;-3.80733177518923;-4.75341748516368;-3.25441128191748;-0.517564306012566;3.00402044226369;-2.25709221524686;-2.24249415100458;-5.54727375556950;-2.15898819874356;-1.16377144612555;-3.09620205109637;-0.445041864456605;-2.86986992225137;1.50172930558122;2.39437103750742;-1.82383181244158;0.249759899251908;-11.6325753158682;-5.13582127523492;-3.69311419607549;-5.15101533006200;-4.17071773988242;-7.17775926076930;-3.63303529949640;-2.55080930743276;-4.86354170559026;-5.91486405897201;-0.791001769489214;3.01053148567721;6.79286071587039;2.37143903549176;0.498156901886153;-7.34582757014134;-2.11100017867841;-0.843132672257601;-3.06392004114983;-3.79610175869757;-6.74906145909455;-2.21077304141430;-0.229889252615193;-4.27220432378624;-4.30887677889652;-6.58679376966737;-0.540373283793333;0.500775234881643;-1.58115911275251;-3.79129463929047;-6.06017201093144;-1.64236000592592;-0.964757518174753;-1.37824426147651;-2.93947469303592;-4.86255032429617;-3.19108593737013;-0.381814546298314;-2.42498953779304;-2.51994259222987;-4.67282889108509;1.49776064845979;1.85298495072805;-0.730080865233367;-1.37481495263444;-6.66364748323833;-0.382342282020639;-1.60385324900826;-4.91847963203889;-4.22553650339555;-6.15175293086973;-4.36774416011340;-0.764872923679969;-3.11025906326002;-5.93412748804025;-4.28731647755635;-0.262262881976867;2.75031153919439;-1.77804816062704;-2.87713102057713;-8.05019596070752;-1.40432112511953;0.835057686888705;-2.64930535498092;-4.25303823124027;-2.55803518376253;0.617922857144154;2.94498991303700;-0.334442593564116;-1.80737359396609;-8.71620716009072;-3.30613793657143;-1.54236214505825;-5.91387572715926;-8.07982841017228;-3.17939402641872;2.02742602101502;3.90376597137900;2.53560556699101;0.570969215685796;-9.47715951421703;-3.00028862418977;-0.456912800299252;-2.48828664312967;-4.99709523546630;-4.38373982764900;-2.44237467550373;0.804035510930343;-3.67606206192048;-2.63799432911594;-7.14689182923821;-4.09600606498571;-0.480273597825783;-5.03464459915907;-3.06497479457314;-1.95878467613723;0.425400407823961;3.25676080685673;-2.62597589758584;-0.189036625390628;-9.50455443598329;-4.44145691016518;-2.99797179345170;-5.57033504736630;-6.63232955037650;-8.09886136373054;-5.57826726857600;-1.83795309643945;-7.01558221028658;-5.20782805242615;-1.78214841657027;2.20500042560505;5.02204981115714;2.48153247254110;-1.01545095530948;-9.86205202990080;-4.55250251894644;-0.506253758364876;-4.72340825778936;-6.01328611442581;-7.21854506595751;-1.45065778202298;-2.31218404709297;-4.85079118915050;-6.78787889004585;-5.89657205384774;-1.41741329493637;0.555968566488055;-1.44308133458854;-3.07521577265127;-7.64656331174665;-2.58467801864059;-0.253160318864680;-3.96875236599553;-4.28523336429551];

theta1D = X(1:Kbeta,1);                  % Estimated Mean Tastes

theta2D = X(Kbeta+1:Kbeta+Ktheta,1);     % Estimated Deviations from Mean Taste


Grad1 = zeros(size(demandmoment,1),Kbeta+Ktheta);
for i = 1:Kbeta+Ktheta
    Grad1(:,i) = gradient(demandmoment, X(i,1));                                 % getting gradients of estimates to be used in variance matrix
end
varianceest_d = pinv(Grad1'*W*Grad1)*Grad1'*W*(demandmoment*demandmoment')*W*Grad1*pinv(Grad1'*W*Grad1); % using GMM variance matrix formulae
sterrors_d    = sqrt(diag(varianceest_d));                                       % getting standard errors of estimated parameters

%% B2) JOINT ESTIMATION:

Kmc     = 1+size(z,2);                      % =4 (constant & cost shifters) # of parameters in MC function
v_J     = randn(Ktheta,I);                  % Draws for share integrals during estimation
zero    = zeros(size(W,1),size(W,1));       % Getting matrix filled with 0s in dimension of W to be used in joint moment minimization

init_J  = rand(Kbeta+Ktheta+Kmc,1);                                        % Initial values for this part

% x_L_J     = [-Inf.*ones(Kbeta,1);zeros(Ktheta,1);-Inf.*ones(Kmc,1)];     % Lower bounds  
% x_U_J     = Inf.*ones(Kbeta+Ktheta+Kmc,1);                               % Upper bounds 

x_L_J     = [-Inf.*ones(Kbeta,1);0.2.*ones(Ktheta,1);-Inf.*ones(Kmc,1)];   % Lower bounds  
x_U_J     = [Inf.*ones(Kbeta,1);0.6.*ones(Ktheta,1);Inf.*ones(Kmc,1)];     % Upper bounds 

tic
[X_J,fval_rep2,exitflag2,output2,lambda2] = fmincon(@BLP_GMM_joint,init_J,[],[],[],[],x_L_J,x_U_J,[],opt);
toc

%For x &w unifrnd specification (all between 0:1), J =6 , M=20, T=10 and
%I=100; sigmaa = [0.8;0.5]; IV  = [constant A z A.^2 z.^2]; 
% X_J = [1.80530635226122;3.21467945579398;0.414823869174088;0.718794589755118;-1.43000481456918;0.00110282861333842;0.000158976637290855;6.42602481939677;0.806897361098574;0.424148145615172;0.515571616501444];

%For x &w unifrnd specification (all between 0:1), J =6 , M=20, T=10 and
%I=100, sigmaa = [0.4;0.3]; IV = [constant A z]
% X_J = [2.91265182935839;3.39228315923168;0.476417911712443;0.718407748704817;-1.78204134882627;0.000501491540912781;8.53838119251060e-05;6.25915668690429;0.815200283979084;0.422578979523716;0.520828153986385];

%For x &w unifrnd specification (all between 0:1), J =6 , M=20, T=10 and
%I=100; sigmaa = [0.4;0.3]; IV  = [constant A z A.^2 z.^2]; ; imposing x_L_J = [-Inf.*ones(Kbeta,1);0.2.*ones(Ktheta,1);-Inf.*ones(Kmc,1)]; x_U_J = [Inf.*ones(Kbeta,1);0.6.*ones(Ktheta,1);Inf.*ones(Kmc,1)];  
% X_J = [4.06848057154175;3.44693092347870;0.547505679793745;0.724040947383360;-2.04404994683005;0.200000431956473;0.200000004137181;6.23361934524577;0.820897830651670;0.425378481047587;0.525701862630701];

%For x &w unifrnd specification (all between 0:1), J =6 , M=20, T=10 and
%I=100, sigmaa = [0.4;0.3], IV = [constant A z]; imposing x_L_J = [-Inf.*ones(Kbeta,1);0.2.*ones(Ktheta,1);-Inf.*ones(Kmc,1)]; x_U_J = [Inf.*ones(Kbeta,1);0.6.*ones(Ktheta,1);Inf.*ones(Kmc,1)];  
% X_J = [3.85699021544880;3.43662918038642;0.537249905024611;0.723376932832757;-1.99375799827837;0.226865978242437;0.200000003029178;6.25067077503461;0.820069552396801;0.425508120013718;0.525486186691283];

%For x &w unifrnd specification (all between 0:1), J =6 , M=20, T=10 and
%I=100, sigmaa = [0.2;0.2], IV = [constant A z]; imposing x_L_J = [-Inf.*ones(Kbeta,1);0.2.*ones(Ktheta,1);-Inf.*ones(Kmc,1)]; x_U_J = [Inf.*ones(Kbeta,1);0.6.*ones(Ktheta,1);Inf.*ones(Kmc,1)];  
% X_J = [4.86253913361880;3.50956156128604;0.615928052652623;0.729719129476131;-2.30529799631233;0.200000065621430;0.200000002231806;6.17494840363584;0.822424318163322;0.424277429930750;0.526505306909295];


%For x &w unifrnd specification (all between 0:1), J =6 , M=20, T=10 and
%I=20, sigmaa = [0.2;0.2], IV = [constant A z]; imposing x_L_J = [-Inf.*ones(Kbeta,1);0.2.*ones(Ktheta,1);-Inf.*ones(Kmc,1)]; x_U_J = [Inf.*ones(Kbeta,1);0.6.*ones(Ktheta,1);Inf.*ones(Kmc,1)];  
% X_J = [4.81213778891114;3.49491909602862;0.581070676757766;0.729883760043176;-2.36279365640201;0.200000133577095;0.200000002427323;6.14721442479078;0.836548957090453;0.426107096910685;0.534961017934312];



xi_J           = error_J;
%For x &w unifrnd specification (all between 0:1), J =6 , M=20, T=10 and
%I=100, sigmaa = [0.2;0.2], IV = [constant A z]; imposing x_L_J = [-Inf.*ones(Kbeta,1);0.2.*ones(Ktheta,1);-Inf.*ones(Kmc,1)]; x_U_J = [Inf.*ones(Kbeta,1);0.6.*ones(Ktheta,1);Inf.*ones(Kmc,1)];  
% xi_J = [0.179257482687382;4.27160459754095;0.615109514910312;-1.05150355140185;0.881991234518265;4.62126342935752;6.25591180688395;1.64674492864945;1.93805161886928;-2.82451408979489;-1.32999975671901;4.23474751592649;0.192103818065104;-2.94311719620362;-1.45548909573838;0.336547936287115;1.28161251448823;-1.11873087934287;-0.625999979187583;-2.42721575373947;2.27063869523128;5.45669801246974;1.61364029563159;1.72899362016280;-3.46167243908800;0.621061658264959;4.42638668882012;-2.81801069967664;-2.32917780797353;-2.19833187777632;4.48895498141865;6.62806445402627;2.24196105807104;3.35471078577256;-5.89403757015886;-2.21639411506288;3.62479363715724;-3.10677485154613;-1.85397732975848;0.131393002681326;2.97160327156301;9.35585940099255;3.06775499579267;3.88432900014908;-1.95535383347844;0.453708717821408;2.57945505063665;-1.70118128350136;-1.11392223876165;0.345153866293503;1.59201456336530;4.38467183690380;0.928656345655419;0.623500102429885;-3.67274912023602;1.48075653534732;3.25991705628942;-1.27746575725181;0.591527131045866;-1.95094853551385;3.65091453705466;5.96555367241375;0.204249105703368;0.414078165883172;-7.08600985047155;-4.35347031467961;2.92022165480885;-3.12267344769301;-2.19723161052256;-5.17843407872036;-1.59369018432075;2.02053066630671;-0.938381288778400;-4.32324639847668;2.20569232801442;7.25351802218802;8.40753469448263;5.06019741340121;2.84497846778706;-4.39288822046459;-1.20190149461886;3.97727478284929;-2.79092660035163;0.252906575785781;-4.01731037900284;0.673219684302380;3.60494320841009;-0.118015218501330;-2.20443645284949;-2.82948015547663;0.977938607973361;5.54648036186923;0.385113850643331;-0.00805896306589204;-4.73590789578196;1.27700847215483;1.62723364418823;-0.525497048050184;-4.56973307985145;-0.804873492781917;2.73374826630169;6.39574328971994;2.19938969617122;2.48074051578351;1.02846731637478;6.81255019773195;10.3311875529553;3.59170030443555;6.27460226966704;0.363575433974463;2.86156742756442;6.75210807968687;1.98302975106677;0.563173728371963;-0.830385965332702;4.70716819515856;3.49574641043035;0.533781828742747;2.42948375175793;0.704217212304974;3.61255448960070;9.18072137141877;4.13338628148614;2.85996511537509;-2.13049842201178;2.48497244166031;6.26645012134110;0.669358889848819;1.20436200260619;2.48354640052711;5.46222569647554;8.72295201552377;3.42336690511526;5.24835869106417;-4.51754895414928;0.612104215722592;2.98005091479488;-1.68444970140163;-2.81405216109133;3.98260504724504;7.24255190164186;11.2393172170910;5.90376197921771;3.33280133123778;-0.339560107414512;1.43093395332976;5.57443250137448;0.375086808844330;1.50707387603709;0.492592491093861;5.51999135636030;7.02008059491712;3.12076122594582;3.09089210120050;-1.90121515062306;1.90583588995014;5.73886230675733;1.00986579910676;-0.790673702560111;1.61559658464967;5.63174257815549;8.04521654977602;6.13571816058721;4.74683829608667;-2.28050327374954;-0.179489020760783;4.02234057199886;-1.33344597969576;-0.740306228311393;-4.95125135069966;1.26573234259170;4.22189765653974;-0.950246699583953;-0.368556550130242;2.56007316366759;6.31732289580243;11.2769391687963;6.53945763667531;6.79514991309885;-2.90712786302704;2.55982575696088;0.956322418906458;-0.436677249839059;-0.408072166936307;-1.82273025380530;3.09624299178062;3.49276254979488;0.491479610081573;-0.000242585012095731;0.0110350943892001;4.07688504014192;7.64803864493038;2.10160044532867;2.75816921802171;-2.41965360771270;0.177801747749969;4.62876592595646;2.27158768155858;-1.51007860502250;-2.81118444985652;1.35297132121802;5.58516702137941;1.15931199197332;1.69353054287437;-2.25194361059167;2.66046466148905;7.73837081589891;3.86388744789186;3.41963740910901;-2.35500517284299;0.905306039966075;3.55385512050204;-1.34009292996618;-0.783019922971706;-5.28103391947720;-0.109564574028035;3.05848272827441;-0.391150599689681;0.378908485111969;-0.392246335675313;2.92290880507729;5.76133181433982;3.39832660789537;2.12573504075284;-4.05748009791288;0.330644757956696;4.20407224683304;-1.77521839908755;-0.904903555804760;-0.461222975269054;3.16328261420069;6.89944727879354;2.93280556367792;3.29107177867490;-6.84798460951012;-0.946253514473359;1.12917573759555;-2.72755722789647;-4.64119757398714;0.483885494807410;3.48494333637186;7.40079598246116;2.55796423125433;3.09175869240149;-5.00561446385542;-0.975550359082575;3.77045594452490;0.384092688681937;0.0439917344779932;-0.872150338972869;2.55634211190504;3.49613453164491;1.19693278583823;-0.759080165023712;-4.15346482199124;1.91001044922195;1.63439688343662;-0.796908238507358;-2.79396783749853;-0.420652745029845;4.46406834873552;7.05069088601186;0.912048265766623;1.19626602508818;-6.02929545793666;-1.65710985597712;-0.0821935753677696;-5.59106804399715;-2.46157236266526;-5.33686525760951;0.254720282745733;1.83515168463120;-4.90321350956580;-3.16331031354002;1.69794581041477;6.51727082224253;7.57421308780366;4.90416114624602;4.74724287886934;-4.04928329649171;1.00686741996748;1.36449259802775;0.213789328182699;-2.32115556801404;-4.85136250367475;-0.773708849604928;2.38586514869302;-1.22686662706731;-1.31170431514552;-1.01155772773692;2.75761076113251;3.06747060747720;0.257631617463121;-0.472391696159721;-5.02121759486673;-0.144913022226386;1.94122507830995;-1.83497746182807;-2.77634103940136;0.784495303329958;5.97785249805640;7.31185192776184;5.62575285332654;3.07470596243857;3.54087723122698;8.19296208588752;8.42987755109285;5.38242244262091;4.50980528382666;-1.11672898769116;2.24931658099505;4.93735994516673;3.48125339816923;2.31028676950718;-0.373140186824345;4.73755318864282;6.04981284667391;3.36554577845586;3.13019958550448;4.22114376423804;7.36441618370586;6.55709577577172;5.01887096281288;5.08614010495477;0.270251233146823;4.45734231994627;6.40830276546645;2.61535647125415;2.67883160127693;2.92053072543568;8.85651260278897;7.90477238453946;6.84706515673810;6.77068441528366;-3.38403721040005;1.96566330193279;3.84811443051432;-1.07196768287250;-0.530919726847956;4.98828546770163;7.32701956846171;11.5794774261994;5.25815677266347;5.73803024793909;-2.35950424988367;1.09644195012964;4.59977329515131;1.13269343647086;0.525724935368439;-0.601322205106259;4.67771619522358;6.92852864370075;3.33962558577863;3.31123117990232;1.21198615852999;4.21366046526719;6.71895568321598;4.16233693688353;2.74997129271952;2.11359944341410;7.39515508941111;11.3753617968566;5.08733481016532;6.60031301233227;-3.57551532286073;0.130467010426733;2.69014341674139;0.396737365780028;-2.10841649749301;-3.99423685454800;1.71842781160925;5.69916302440998;1.67025573824690;0.674207627547729;3.66793215683337;8.93962233768325;13.7109696829409;9.54942352114343;6.83237663329478;-0.518197266259869;1.52705236775266;4.88488439910654;0.726755602222496;1.35881814624867;-2.90094462555565;3.63744988564564;5.50499350927496;2.49977327568120;0.914483896630337;0.138437723867647;3.11490626040419;6.46840331482460;3.32900764865345;3.34711836722654;-1.36218580718301;3.38062941859493;3.74716824781857;2.05644988988614;2.57076638278202;-4.04910264835567;-2.35070112941358;2.87522865923189;-1.93171827422806;-0.502770635681170;-1.73209690791341;0.618510201916631;4.38633902211595;1.25201108013952;-2.67739279291812;-7.40377314312963;-2.34567942085006;-0.916768276646155;-5.45581405632302;-2.32814454298646;-7.67781946259562;-1.00740434382767;-1.01650743575071;-2.79917060475106;-3.51374252310264;-3.99401219758787;-0.611317027051683;2.50251954016251;-1.08605095630046;-3.04960141406008;-6.52733230760302;-3.52939993053940;0.576095749414090;-2.96520240475141;-3.88868840889000;-2.54716721624303;-0.257790601588737;3.33794031276945;0.606553626263425;-0.320132331530457;-12.2249764467056;-5.27871937054295;-2.67210425488626;-5.89098051791967;-7.47655134475767;-1.91875791142715;2.41670244511059;5.71854803310296;0.507655074540626;1.16875526875768;-7.90165632093843;-4.69087790596663;-1.87298435653952;-5.13713726241302;-4.84971540237022;-4.43886961149446;-1.13960012272422;1.37351269048982;-1.19859072207821;-2.43517753916467;-8.17453007527288;-2.36415623428452;-0.837832363946991;-2.02291010617037;-3.62144776130509;-3.41721151471976;-0.129635937466279;5.07127177045765;-0.399795932792772;-2.24753417193899;-9.55035019040056;-4.15106723883375;-2.97725961528404;-6.35924466838842;-7.26827949035033;-8.98826575358671;-3.18766425880916;0.561668869201480;-3.49346554500631;-5.59210513682711;-0.142598422641036;3.24150244495535;2.96178194696739;1.47735286805941;0.878816201466095;-7.79156904404348;-3.53844874179049;0.251006815785608;-6.11654669828122;-2.14384971023488;-5.67987245551103;-2.70745668896760;0.513156298541308;-4.92036748013486;-5.42612182681236;-5.21895074231161;0.379425680554670;2.44271911798976;0.132055820302679;-3.01643713552860;-7.95750653905144;-6.11317845777089;-1.22110976324322;-3.68615188342815;-4.79137837708264;-2.91007145097080;0.303986190556422;3.14779999730012;3.01026119725825;-1.00144520036626;-0.492530252705098;2.89295705860321;7.10462769494045;3.37783597131614;2.10863096761615;-4.44820926927005;1.89722106872971;3.16284712715668;-0.781851409362209;-1.39071665526935;-2.68310403955807;0.879919827198956;2.38003400134987;0.0152811839033280;-1.78213207059486;-3.03361068431420;2.85598938106101;3.26186761526664;0.977711438961022;1.31416833610197;-5.08650629980566;0.867225813125616;1.71086070154831;-0.214011293963575;-0.0353374053217674;-2.33369663170760;1.39324567783763;6.54440318392697;1.78684273692180;1.44545348282674;-5.69467136484942;-3.73721487794972;1.41827032526544;-2.90631008094919;-4.44954257246906;-0.643065437358605;5.66243329517257;6.81907822788057;4.23874174867797;6.22858045693938;-4.29041455163391;0.259270928666757;1.70335410324352;0.376204421936999;-1.97157051953229;-3.72137368142355;1.96429275652030;2.36066948806921;1.66787558724980;-1.16570166389354;-4.21065032994672;0.911740441269020;2.86678480251042;-1.15793452962341;-2.68171712650428;-1.61331383912212;3.66156361812003;4.26159280285287;0.0744848032507237;-0.0175407274268249;-5.58263544669359;-3.01730675951876;0.270688078582497;-4.58493384633188;-4.71439463514040;-6.44308878794688;-2.01332748671036;2.11361598992437;-1.49214862225899;-4.73921262237170;1.30669314420007;3.88267241296407;7.30796241356481;3.98865491680893;5.11268560317746;-5.56635760769415;-2.69117098468205;1.43607632401626;-1.56069129879964;-2.30545190802376;-2.62288262961503;-0.896020688375936;1.22640570672530;-1.59309139904328;-3.33213208875707;-3.63813148900625;0.839484550136790;5.05627826983928;1.41516142689524;-0.405471752491398;-3.52275362471013;0.103457520417807;1.17984381122088;-3.55036699964096;-3.93553785795648;-3.34907588240868;1.87004084029981;3.52178852655932;0.279609550933777;0.924966363711649;-2.74614231930875;1.25574877071680;6.30374449734759;0.958603181352764;3.24358073704424;-4.09302328242974;-1.81392633743215;1.37859592184463;-1.48878979783745;-1.60695901029690;-4.74215125138095;-1.44566924871784;0.0213080066905684;-2.43627561754365;-4.85323621075431;-2.24826224717349;1.10896906974117;3.72239544763839;-1.02817454933585;1.26445224229753;-4.16778636538481;-1.96248353527289;0.0708857081025727;-1.39499962653612;-1.88179432989733;-2.24241770500656;2.08541373633518;4.89488641037818;0.895966173056616;2.56594253465270;-7.14252422274321;-4.76888566447801;-1.97949592406215;-3.55100140958295;-5.48816928710740;-2.11814199862142;4.46702842816165;6.40848228722870;4.63399528923869;1.13282731230812;-5.31592829365461;-0.958954474456995;1.62489114064191;-4.37985025011196;-3.56447505242639;-3.02022100407657;0.649733121126836;2.18221321885053;-0.174528012130686;-2.68555066134020;-4.17500711836365;-0.909064842585237;1.78979352276833;-1.38910827011874;-2.50749573910300;-1.39317140909843;0.624976955225497;4.32644415864513;0.885637027598366;0.582547601407836;-7.40525315302524;-5.35144627726283;-0.518418755351901;-3.13955622869560;-7.48332718106392;-7.52182941351785;-3.81171028015716;-1.42009703825397;-2.74966542215287;-3.03293635985606;-0.680908336294238;3.91123180045448;8.75156671732614;2.43197824190535;2.69371855841065;-7.30055470276294;-2.12278451959114;-1.33666020729023;-3.56782620523458;-4.95705824928107;-6.23828407629156;-1.31804253092109;2.55281413120920;-3.48916284696230;-2.56134234462144;-4.07632512427188;0.489520929180406;5.04244590935103;-0.730264140795979;-2.08663846350144;-5.16506642558004;-0.784936960655804;-1.01205194909481;-3.48429594782112;-3.94409575298744;-1.99153950652109;2.69994158276398;4.78272265538350;2.28102846001838;1.56335722174910;-0.396408552836983;5.15240986044363;6.12961443656202;4.27569493122642;3.38796089362366;-2.33362225556848;0.471691089836680;4.66331106750093;-0.0712017468130259;-0.319261560921024;-3.53439112028920;1.74939477577658;5.14997113536094;0.192629642055840;-0.0945552756440087;-1.67351183100345;4.17718275761949;4.92931011130505;2.49112171336289;3.29670072712315;-3.13048980060566;3.00259741202015;3.35164270212911;0.759503030243528;0.148579366432582;-1.23790072105086;3.61259489296836;7.88475514926015;2.08698880065563;2.52447700732934;-6.61452245148122;-2.36030972168380;-0.0367852153581634;-1.54014447726056;-3.38089211403015;1.44697022865855;5.57183212699331;7.71903285331388;6.07574961550089;2.69574599516196;-4.53566573825886;1.23374395771519;4.73135716463748;-1.02119990210332;-0.957386240550841;-2.78374189335911;3.71116074996189;5.14062663237344;0.802915800696638;1.53772065634567;-2.02875732260159;1.14776761676421;2.42466211375151;-0.590059993608639;-2.02915885434293;-0.00344575441359751;5.08085991683571;5.70700924534349;3.28174791808830;1.34976135764444;-3.97671821677170;-3.04974547496641;0.707322483809842;-1.65695912760524;-2.39422569049189;-4.96953150114095;-0.347530799171208;3.81777035697040;-1.54348337261462;-1.19727249572804;2.30099368097002;5.71913895432458;10.5270009012032;5.47864353119383;3.23099072164396;-5.10153133494410;0.127903141290869;3.28339053624562;-0.196841397290196;-1.21990426744014;-5.05439696823109;-1.25809297423093;4.29278837373590;0.514104067874332;-0.462349266370580;-0.187152164920548;4.05478216431265;3.57995328722058;0.822609689696818;1.23364668765942;-4.50657273394504;0.567033435931479;3.46080162783909;0.130313883631938;-3.80936733849602;-4.50498085016275;-0.110124666700260;0.997524888466900;-0.0481871964288541;-0.702766013531781;-2.64136865497278;1.93291003298634;2.34268943814210;-0.879295775989000;-0.971301773398156;-6.48947314306739;-2.55906736685030;-0.685815159472464;-2.10979457868053;-3.09967888936820;-4.86914247863910;-1.78226478803357;-0.373585991724568;-5.31036805613820;-3.33355915894689;-3.96058046771989;0.968295031983150;4.07981515451395;-0.504034031015133;-1.24475423863928;-6.86172349847990;-0.364350524509985;1.14726786817064;-2.80486256253302;-3.42930882643023;-0.917470257169988;3.08801352171215;3.91588425436131;1.08380731409342;0.164420208144983;-8.28604805762303;-4.26662351209467;0.254116156874691;-5.70014767728490;-6.50052539006671;-2.11833202857945;3.52459482350839;5.50429111185421;2.21199562245045;0.0572884869024932;-6.37279053031009;-4.49689475259395;0.617111127513530;-3.85777236423208;-4.84771633109931;-3.29263685136346;-0.569238329019131;2.96451888365676;-2.33272820639203;-2.28986101614899;-5.59017540371462;-2.20920910297079;-1.22212918493297;-3.13368897459410;-0.496968780307076;-2.82667285234634;1.55593600360952;2.37389138657865;-1.78078883068509;0.322707432584958;-11.6887412052862;-5.18746101492251;-3.77281731045144;-5.19386860470146;-4.20349700881890;-7.23801030387041;-3.69062869402750;-2.60602135213865;-4.91673519297590;-5.96194629788433;-0.672648182199196;3.15486324019871;6.89962310017851;2.51054767102036;0.648463140568028;-7.39757354305575;-2.15220534187901;-0.887966725244814;-3.09969766073937;-3.82774061502408;-6.82941018032925;-2.24220730120880;-0.286105919966765;-4.35195642441393;-4.37096403625253;-6.64906855937730;-0.586556089962453;0.442617839999699;-1.64222267616433;-3.85757211468843;-6.13471915074249;-1.68659659728885;-1.02318665887755;-1.41845859488727;-2.98662326194103;-4.91717625498274;-3.24998620112220;-0.454141214399832;-2.45874989214902;-2.55217978890672;-4.56553266786536;1.56019227962245;1.84186111630141;-0.688549217562672;-1.29528867393150;-6.71506247621910;-0.413063148343358;-1.64901350599962;-4.99173867284152;-4.26762115402072;-6.18564400814231;-4.43969537866590;-0.807620455413199;-3.16042937524733;-5.99507154521878;-4.36783971547898;-0.324065471287309;2.70978246367868;-1.84600903915833;-2.92240761443735;-8.09318997718205;-1.43167656172440;0.791787133884135;-2.69588151175275;-4.31123605552934;-2.63356759372813;0.560510084114770;2.91186294445372;-0.378831835606572;-1.85907992688551;-8.75912952375657;-3.34494511713936;-1.58793465772114;-5.96216461832909;-8.12511641078405;-3.19739130989474;1.99466543647731;3.87651303364461;2.52581346359638;0.534227584209141;-9.55178007743834;-3.07345379478655;-0.517916920570647;-2.52874290675881;-5.05412916571789;-4.40852248456447;-2.48307156478780;0.752528989169606;-3.73094818720718;-2.67827396832037;-7.17480588034892;-4.14580477485451;-0.533679832670599;-5.09954411852559;-3.11686620554830;-2.00367646411017;0.380782150223775;3.22493150427378;-2.66392299175777;-0.251070776463229;-9.54056323143491;-4.48353713044837;-3.06202748614539;-5.61644351596216;-6.68597811764087;-8.14520937592545;-5.64084223631760;-1.89471004672156;-7.06973403459711;-5.23865554656729;-1.78082738099667;2.20274650038274;5.01491279009645;2.49264647644225;-1.03932930102362;-9.91986533837791;-4.60298247295476;-0.535641233611887;-4.77426330134387;-6.06958537452026;-7.27970870011809;-1.50990813540748;-2.38562831889513;-4.88833822111865;-6.83691642184260;-5.94289872056586;-1.49871434494818;0.527336115322482;-1.47414537614551;-3.10267149037516;-7.69309179647313;-2.63748933626978;-0.292183074532016;-4.01115948503829;-4.35936378220904];

demandmoment_J = gg;

supplymoment_J = zeta;

mc_J           = marginalcost;

theta1J = X_J(1:Kbeta,1);                        % Estimated Mean Tastes

theta2J = X_J(Kbeta+1:Kbeta+Ktheta,1);           % Estimated Deviations from Mean Taste

gammaJ  = X_J(Kbeta+Ktheta+1:Kbeta+Ktheta+Kmc);  % MC estimates

theta_J = [theta1J; theta2J];



Grad2 = zeros(size(demandmoment_J,1),Kbeta+Ktheta);
for i = 1:Kbeta+Ktheta
    Grad2(:,i) = gradient(demandmoment_J, X_J(i,1));                       % Getting gradients of demand-side estimates to be used in variance matrix
end
varianceestQ2D  = pinv(Grad2'*W*Grad2)*Grad2'*W*(demandmoment_J*demandmoment_J')*W*Grad2*pinv(Grad2'*W*Grad2); 
                                                                           % Using GMM variance matrix formulae for demand-side
sterrorsQ2D     = sqrt(diag(varianceestQ2D));                              % Getting standard errors of demand-side

Grad3 = zeros(size(supplymoment_J,1),Kmc);
for i = 1:Kmc
    Grad3(:,i) = gradient(supplymoment_J, gammaJ(i,1));                    % Getting gradients of supply-side estimates to be used in variance matrix
end
varianceestQ2S = pinv(Grad3'*W*Grad3)*Grad3'*W*(supplymoment_J*supplymoment_J')*W*Grad3*pinv(Grad3'*W*Grad3);  
                                                                           % Using GMM variance matrix formulae for supply-side
sterrorsQ2S     = sqrt(diag(varianceestQ2S));                              % Getting standard errors of supply-side
sterrors_j      = [sterrorsQ2D; sterrorsQ2S];                              % Stacking demand-side & supply-side errors together

%% 3 - COUNTERFACTUAL - INTRODUCTION OF THE EXISTING PRODUCT IN FIRST MARKET FOR FIRST TIME PERIOD:

% ASSUME THAT THE RESEARCHER HAVE ACCESS TO THE x_jmt and w_jmt for the
% first product.













